var Ie=Object.defineProperty;var Te=(e,t,n)=>t in e?Ie(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var re=(e,t,n)=>(Te(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();function te(){}function ve(e){return e()}function ue(){return Object.create(null)}function x(e){e.forEach(ve)}function ke(e){return typeof e=="function"}function ze(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function Fe(e){return Object.keys(e).length===0}function Ve(e){return e??""}function D(e,t){e.appendChild(t)}function P(e,t,n){e.insertBefore(t,n||null)}function L(e){e.parentNode&&e.parentNode.removeChild(e)}function se(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function z(e){return document.createElement(e)}function F(e){return document.createTextNode(e)}function J(){return F(" ")}function Be(){return F("")}function X(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function I(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function je(e){return Array.from(e.childNodes)}function le(e,t){t=""+t,e.data!==t&&(e.data=t)}function H(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function R(e,t,n){e.classList.toggle(t,!!n)}let ne;function ee(e){ne=e}function Ce(){if(!ne)throw new Error("Function called outside component initialization");return ne}function Ke(e){Ce().$$.on_mount.push(e)}function qe(e){Ce().$$.on_destroy.push(e)}const W=[],ae=[];let Z=[];const de=[],Qe=Promise.resolve();let ce=!1;function Xe(){ce||(ce=!0,Qe.then(Me))}function fe(e){Z.push(e)}const ie=new Set;let U=0;function Me(){if(U!==0)return;const e=ne;do{try{for(;U<W.length;){const t=W[U];U++,ee(t),Ye(t.$$)}}catch(t){throw W.length=0,U=0,t}for(ee(null),W.length=0,U=0;ae.length;)ae.pop()();for(let t=0;t<Z.length;t+=1){const n=Z[t];ie.has(n)||(ie.add(n),n())}Z.length=0}while(W.length);for(;de.length;)de.pop()();ce=!1,ie.clear(),ee(e)}function Ye(e){if(e.fragment!==null){e.update(),x(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(fe)}}function He(e){const t=[],n=[];Z.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),Z=t}const Ue=new Set;function $e(e,t){e&&e.i&&(Ue.delete(e),e.i(t))}function q(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function Ge(e,t){e.d(1),t.delete(e.key)}function Je(e,t,n,o,l,r,i,d,m,u,p,c){let h=e.length,S=r.length,M=h;const K={};for(;M--;)K[e[M].key]=M;const $=[],V=new Map,T=new Map,A=[];for(M=S;M--;){const g=c(l,r,M),b=n(g);let k=i.get(b);k?o&&A.push(()=>k.p(g,t)):(k=u(b,g),k.c()),V.set(b,$[M]=k),b in K&&T.set(b,Math.abs(M-K[b]))}const B=new Set,E=new Set;function j(g){$e(g,1),g.m(d,p),i.set(g.key,g),p=g.first,S--}for(;h&&S;){const g=$[S-1],b=e[h-1],k=g.key,v=b.key;g===b?(p=g.first,h--,S--):V.has(v)?!i.has(k)||B.has(k)?j(g):E.has(v)?h--:T.get(k)>T.get(v)?(E.add(k),j(g)):(B.add(v),h--):(m(b,i),h--)}for(;h--;){const g=e[h];V.has(g.key)||m(g,i)}for(;S;)j($[S-1]);return x(A),$}function We(e,t,n){const{fragment:o,after_update:l}=e.$$;o&&o.m(t,n),fe(()=>{const r=e.$$.on_mount.map(ve).filter(ke);e.$$.on_destroy?e.$$.on_destroy.push(...r):x(r),e.$$.on_mount=[]}),l.forEach(fe)}function Ze(e,t){const n=e.$$;n.fragment!==null&&(He(n.after_update),x(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function xe(e,t){e.$$.dirty[0]===-1&&(W.push(e),Xe(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function et(e,t,n,o,l,r,i=null,d=[-1]){const m=ne;ee(e);const u=e.$$={fragment:null,ctx:[],props:r,update:te,not_equal:l,bound:ue(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:ue(),dirty:d,skip_bound:!1,root:t.target||m.$$.root};i&&i(u.root);let p=!1;if(u.ctx=n?n(e,t.props||{},(c,h,...S)=>{const M=S.length?S[0]:h;return u.ctx&&l(u.ctx[c],u.ctx[c]=M)&&(!u.skip_bound&&u.bound[c]&&u.bound[c](M),p&&xe(e,c)),h}):[],u.update(),p=!0,x(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const c=je(t.target);u.fragment&&u.fragment.l(c),c.forEach(L)}else u.fragment&&u.fragment.c();t.intro&&$e(e.$$.fragment),We(e,t.target,t.anchor),Me()}ee(m)}class tt{constructor(){re(this,"$$");re(this,"$$set")}$destroy(){Ze(this,1),this.$destroy=te}$on(t,n){if(!ke(n))return te;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}$set(t){this.$$set&&!Fe(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const nt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(nt);function ot(e,t,n,o){const l=lt(e),r=rt(e,t),i=it(e,t,n,o);return l+(r?10:0)+(i?5:0)}function lt(e){const t=e.map(l=>l.map(()=>!1));let n=0;function o(l,r,i){if(l<0||l>=e.length||r<0||r>=e[0].length||t[l][r]||e[l][r].terrain!==i)return[0,0];t[l][r]=!0;let d=1,m=e[l][r].crowns;for(const[u,p]of[[1,0],[-1,0],[0,1],[0,-1]]){const[c,h]=o(l+u,r+p,i);d+=c,m+=h}return[d,m]}for(let l=0;l<e.length;l++)for(let r=0;r<e[0].length;r++){const i=e[l][r];if(i.terrain&&!t[l][r]){const[d,m]=o(l,r,i.terrain);n+=d*m}}return n}function rt(e,t){const{minRow:n,maxRow:o,minCol:l,maxCol:r}=Re(e,t),i=Math.floor((n+o)/2),d=Math.floor((l+r)/2),m=t.row===i&&t.col===d,u=o-n+1===5&&r-l+1===5;return m&&u}function it(e,t,n,o){const{minRow:l,maxRow:r,minCol:i,maxCol:d}=Re(e,t),m=r-l+1===o&&d-i+1===o;for(let u=n.row;u<n.row+o;u++)for(let p=n.col;p<n.col+o;p++)if((u!==t.row||p!==t.col)&&e[u][p].terrain===null)return!1;return m}function Re(e,t){let n=e.length,o=-1,l=e[0].length,r=-1;for(let i=0;i<e.length;i++)for(let d=0;d<e[0].length;d++)(e[i][d].terrain!==null||i===t.row&&d===t.col)&&(n=Math.min(n,i),o=Math.max(o,i),l=Math.min(l,d),r=Math.max(r,d));return{minRow:n,maxRow:o,minCol:l,maxCol:r}}function he(e,t,n){const o=e.slice();return o[32]=t[n],o}function me(e,t,n){const o=e.slice();return o[35]=t[n],o}function _e(e,t,n){const o=e.slice();return o[38]=t[n].tile,o[39]=t[n].row,o[40]=t[n].col,o}function pe(e,t,n){const o=e.slice();return o[43]=t[n],o}function we(e){let t,n,o;function l(){return e[15](e[43])}return{c(){t=z("button"),t.textContent=`${e[43]} ðŸ‘‘`,I(t,"class","svelte-1p6di0"),R(t,"selected",e[2]===e[43])},m(r,i){P(r,t,i),n||(o=X(t,"click",l),n=!0)},p(r,i){e=r,i[0]&4&&R(t,"selected",e[2]===e[43])},d(r){r&&L(t),n=!1,o()}}}function ge(e){let t,n=(e[38].crowns>0?e[38].crowns:"")+"",o,l,r,i,d,m;function u(){return e[16](e[38],e[39],e[40])}function p(...c){return e[17](e[38],e[39],e[40],...c)}return{c(){t=z("button"),o=F(n),l=J(),I(t,"data-row",r=e[39]),I(t,"data-col",i=e[40]),I(t,"class","tile svelte-1p6di0"),R(t,"grass",e[38].terrain==="grass"),R(t,"water",e[38].terrain==="water"),R(t,"forest",e[38].terrain==="forest"),R(t,"wheat",e[38].terrain==="wheat"),R(t,"swamp",e[38].terrain==="swamp"),R(t,"mine",e[38].terrain==="mine"),R(t,"castle",e[11](e[39],e[40]))},m(c,h){P(c,t,h),D(t,o),D(t,l),d||(m=[X(t,"click",u),X(t,"pointerdown",p),X(t,"pointermove",e[18]),X(t,"pointerup",e[19])],d=!0)},p(c,h){e=c,h[0]&16&&n!==(n=(e[38].crowns>0?e[38].crowns:"")+"")&&le(o,n),h[0]&16&&r!==(r=e[39])&&I(t,"data-row",r),h[0]&16&&i!==(i=e[40])&&I(t,"data-col",i),h[0]&16&&R(t,"grass",e[38].terrain==="grass"),h[0]&16&&R(t,"water",e[38].terrain==="water"),h[0]&16&&R(t,"forest",e[38].terrain==="forest"),h[0]&16&&R(t,"wheat",e[38].terrain==="wheat"),h[0]&16&&R(t,"swamp",e[38].terrain==="swamp"),h[0]&16&&R(t,"mine",e[38].terrain==="mine"),h[0]&2064&&R(t,"castle",e[11](e[39],e[40]))},d(c){c&&L(t),d=!1,x(m)}}}function ye(e){let t,n=q(e[35]),o=[];for(let l=0;l<n.length;l+=1)o[l]=ge(_e(e,n,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();t=Be()},m(l,r){for(let i=0;i<o.length;i+=1)o[i]&&o[i].m(l,r);P(l,t,r)},p(l,r){if(r[0]&3536){n=q(l[35]);let i;for(i=0;i<n.length;i+=1){const d=_e(l,n,i);o[i]?o[i].p(d,r):(o[i]=ge(d),o[i].c(),o[i].m(t.parentNode,t))}for(;i<o.length;i+=1)o[i].d(1);o.length=n.length}},d(l){l&&L(t),se(o,l)}}}function be(e,t){let n,o=t[32]+"",l,r,i;function d(){return t[20](t[32])}return{key:e,first:null,c(){n=z("button"),l=F(o),I(n,"class",Ve(t[32])+" svelte-1p6di0"),R(n,"selected",t[1]===t[32]),this.first=n},m(m,u){P(m,n,u),D(n,l),r||(i=X(n,"click",d),r=!0)},p(m,u){t=m,u[0]&34&&R(n,"selected",t[1]===t[32])},d(m){m&&L(n),r=!1,i()}}}function st(e){let t,n,o,l,r,i,d,m=[],u=new Map,p,c,h,S,M,K,$,V,T,A,B,E,j,g=q([0,1,2,3]),b=[];for(let s=0;s<4;s+=1)b[s]=we(pe(e,g,s));let k=q(e[4]),v=[];for(let s=0;s<k.length;s+=1)v[s]=ye(me(e,k,s));let Y=q(["empty",...e[5]]);const oe=s=>s[32];for(let s=0;s<Y.length;s+=1){let w=he(e,Y,s),f=oe(w);u.set(f,m[s]=be(f,w))}return{c(){t=z("h1"),t.textContent="Kingdomino Scorer",n=J(),o=z("div");for(let s=0;s<4;s+=1)b[s].c();l=J(),r=z("div");for(let s=0;s<v.length;s+=1)v[s].c();i=J(),d=z("div");for(let s=0;s<m.length;s+=1)m[s].c();p=J(),c=z("p"),h=F("Total Score: "),S=z("strong"),M=F(e[3]),K=J(),$=z("button"),V=F("Board Size: "),T=F(e[0]),A=F("Ã—"),B=F(e[0]),H(t,"text-align","center"),I(o,"class","crown-controls controls svelte-1p6di0"),I(r,"class","board svelte-1p6di0"),H(r,"--board-size",e[0]),I(d,"class","controls svelte-1p6di0"),H($,"margin-left","20px"),I($,"class","svelte-1p6di0"),H(c,"text-align","center"),H(c,"font-size","1.2rem")},m(s,w){P(s,t,w),P(s,n,w),P(s,o,w);for(let f=0;f<4;f+=1)b[f]&&b[f].m(o,null);P(s,l,w),P(s,r,w);for(let f=0;f<v.length;f+=1)v[f]&&v[f].m(r,null);P(s,i,w),P(s,d,w);for(let f=0;f<m.length;f+=1)m[f]&&m[f].m(d,null);P(s,p,w),P(s,c,w),D(c,h),D(c,S),D(S,M),D(c,K),D(c,$),D($,V),D($,T),D($,A),D($,B),E||(j=X($,"click",e[21]),E=!0)},p(s,w){if(w[0]&4){g=q([0,1,2,3]);let f;for(f=0;f<4;f+=1){const Q=pe(s,g,f);b[f]?b[f].p(Q,w):(b[f]=we(Q),b[f].c(),b[f].m(o,null))}for(;f<4;f+=1)b[f].d(1)}if(w[0]&3536){k=q(s[4]);let f;for(f=0;f<k.length;f+=1){const Q=me(s,k,f);v[f]?v[f].p(Q,w):(v[f]=ye(Q),v[f].c(),v[f].m(r,null))}for(;f<v.length;f+=1)v[f].d(1);v.length=k.length}w[0]&1&&H(r,"--board-size",s[0]),w[0]&546&&(Y=q(["empty",...s[5]]),m=Je(m,w,oe,1,s,Y,u,d,Ge,be,null,he)),w[0]&8&&le(M,s[3]),w[0]&1&&le(T,s[0]),w[0]&1&&le(B,s[0])},i:te,o:te,d(s){s&&(L(t),L(n),L(o),L(l),L(r),L(i),L(d),L(p),L(c)),se(b,s),se(v,s);for(let w=0;w<m.length;w+=1)m[w].d();E=!1,j()}}}const G=13;function ct(e,t,n){let o,l=!1,r=null,i=null;function d(){l=!1,r=null,i=null}Ke(()=>{window.addEventListener("pointerup",d),window.addEventListener("pointercancel",d)}),qe(()=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",d)});const m=["grass","water","forest","wheat","swamp","mine"];let u=Array.from({length:G},()=>Array.from({length:G},()=>({terrain:null,crowns:0}))),p=5,c={row:4,col:4},h={row:6,col:6};function S(a,_,y){g(_,y)?i={row:_,col:y}:E===null&&(l=!0,r=A==="empty"?null:A,T(a,_,y))}function M(a){const _=document.elementFromPoint(a.clientX,a.clientY);if(!(_!=null&&_.dataset))return;const y=parseInt(_.dataset.row??""),N=parseInt(_.dataset.col??"");if(!(isNaN(y)||isNaN(N))){if(i){const C=y-i.row,O=N-i.col;K(h.row+C,h.col+O),i=null}l=!1,r=null}}function K(a,_){const y=a-h.row,N=_-h.col,C={row:c.row-y,col:c.col-N},{minRow:O,maxRow:Ne,minCol:Ee,maxCol:Le}=b(),Ae=C.row,Oe=C.row+p-1,Pe=C.col,De=C.col+p-1;return O>=Ae&&Ne<=Oe&&Ee>=Pe&&Le<=De?(n(14,c=C),$(),!0):!1}function $(){n(13,u=[...u]),n(3,k=ot(u,h,c,p))}function V(a){if(!l||r===null)return;const _=document.elementFromPoint(a.clientX,a.clientY);if(!(_!=null&&_.dataset))return;const y=parseInt(_.dataset.row??""),N=parseInt(_.dataset.col??"");if(isNaN(y)||isNaN(N))return;const C=u[y][N];T(C,y,N)}function T(a,_,y){g(_,y)||l&&r!==null&&(console.log("applyDrag: terrain",r),a.terrain=r,$())}let A="grass";function B(a){n(1,A=a)}let E=null;function j(a,_,y){g(_,y)||(E!==null?(console.log("applySelection: crown",E),a.crowns=E,n(2,E=null)):(console.log("applySelection: terrain",A),a.terrain=A==="empty"?null:A),$())}function g(a,_){return a===h.row&&_===h.col}function b(){let a=G,_=-1,y=G,N=-1;for(let C=0;C<G;C++)for(let O=0;O<G;O++)(u[C][O].terrain!==null||C===h.row&&O===h.col)&&(a=Math.min(a,C),_=Math.max(_,C),y=Math.min(y,O),N=Math.max(N,O));return{minRow:a,maxRow:_,minCol:y,maxCol:N}}let k=0;function v(){if(p===5)n(0,p=7),c.row>0&&n(14,c.row-=1,c),c.col>0&&n(14,c.col-=1,c);else{const a=b();if(a.maxRow-a.minRow>=5||a.maxCol-a.minCol>=5)return;const _=a.maxRow<c.row+6?c.row+1:c.row,y=a.maxCol<c.col+6?c.col+1:c.col;n(14,c={row:_,col:y}),n(0,p=5)}}const Y=a=>n(2,E=a),oe=(a,_,y)=>j(a,_,y),s=(a,_,y,N)=>S(a,_,y),w=a=>V(a),f=a=>M(a),Q=a=>B(a),Se=()=>v();return e.$$.update=()=>{e.$$.dirty[0]&24577&&n(4,o=Array.from({length:p},(a,_)=>Array.from({length:p},(y,N)=>{const C=c.row+_,O=c.col+N;return{tile:u[C][O],row:C,col:O}})))},[p,A,E,k,o,m,S,M,V,B,j,g,v,u,c,Y,oe,s,w,f,Q,Se]}class ft extends tt{constructor(t){super(),et(this,t,ct,st,ze,{},null,[-1,-1])}}new ft({target:document.body});
