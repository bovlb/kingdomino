var Ve=Object.defineProperty;var ze=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var fe=(e,t,n)=>(ze(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function o(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function re(){}function $e(e){return e()}function he(){return Object.create(null)}function oe(e){e.forEach($e)}function Ee(e){return typeof e=="function"}function Be(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function je(e){return Object.keys(e).length===0}function He(e){return e??""}function E(e,t){e.appendChild(t)}function P(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function ae(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function F(e){return document.createElement(e)}function V(e){return document.createTextNode(e)}function U(){return V(" ")}function Qe(){return V("")}function J(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function z(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Xe(e){return Array.from(e.childNodes)}function ce(e,t){t=""+t,e.data!==t&&(e.data=t)}function Y(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function v(e,t,n){e.classList.toggle(t,!!n)}let ie;function le(e){ie=e}function Se(){if(!ie)throw new Error("Function called outside component initialization");return ie}function Ye(e){Se().$$.on_mount.push(e)}function Ue(e){Se().$$.on_destroy.push(e)}const te=[],_e=[];let ne=[];const we=[],Ge=Promise.resolve();let de=!1;function Je(){de||(de=!0,Ge.then(Le))}function me(e){ne.push(e)}const ue=new Set;let x=0;function Le(){if(x!==0)return;const e=ie;do{try{for(;x<te.length;){const t=te[x];x++,le(t),We(t.$$)}}catch(t){throw te.length=0,x=0,t}for(le(null),te.length=0,x=0;_e.length;)_e.pop()();for(let t=0;t<ne.length;t+=1){const n=ne[t];ue.has(n)||(ue.add(n),n())}ne.length=0}while(te.length);for(;we.length;)we.pop()();de=!1,ue.clear(),le(e)}function We(e){if(e.fragment!==null){e.update(),oe(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(me)}}function Ze(e){const t=[],n=[];ne.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),ne=t}const xe=new Set;function Ae(e,t){e&&e.i&&(xe.delete(e),e.i(t))}function G(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function et(e,t){e.d(1),t.delete(e.key)}function tt(e,t,n,o,r,i,s,d,m,u,_,f){let h=e.length,w=i.length,k=h;const Q={};for(;k--;)Q[e[k].key]=k;const C=[],H=new Map,T=new Map,D=[];for(k=w;k--;){const y=f(r,i,k),M=n(y);let R=s.get(M);R?o&&D.push(()=>R.p(y,t)):(R=u(M,y),R.c()),H.set(M,C[k]=R),M in Q&&T.set(M,Math.abs(k-Q[M]))}const L=new Set,I=new Set;function B(y){Ae(y,1),y.m(d,_),s.set(y.key,y),_=y.first,w--}for(;h&&w;){const y=C[w-1],M=e[h-1],R=y.key,j=M.key;y===M?(_=y.first,h--,w--):H.has(j)?!s.has(R)||L.has(R)?B(y):I.has(j)?h--:T.get(R)>T.get(j)?(I.add(R),B(y)):(L.add(j),h--):(m(M,s),h--)}for(;h--;){const y=e[h];H.has(y.key)||m(y,s)}for(;w;)B(C[w-1]);return oe(D),C}function nt(e,t,n){const{fragment:o,after_update:r}=e.$$;o&&o.m(t,n),me(()=>{const i=e.$$.on_mount.map($e).filter(Ee);e.$$.on_destroy?e.$$.on_destroy.push(...i):oe(i),e.$$.on_mount=[]}),r.forEach(me)}function ot(e,t){const n=e.$$;n.fragment!==null&&(Ze(n.after_update),oe(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function lt(e,t){e.$$.dirty[0]===-1&&(te.push(e),Je(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function rt(e,t,n,o,r,i,s=null,d=[-1]){const m=ie;le(e);const u=e.$$={fragment:null,ctx:[],props:i,update:re,not_equal:r,bound:he(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:he(),dirty:d,skip_bound:!1,root:t.target||m.$$.root};s&&s(u.root);let _=!1;if(u.ctx=n?n(e,t.props||{},(f,h,...w)=>{const k=w.length?w[0]:h;return u.ctx&&r(u.ctx[f],u.ctx[f]=k)&&(!u.skip_bound&&u.bound[f]&&u.bound[f](k),_&&lt(e,f)),h}):[],u.update(),_=!0,oe(u.before_update),u.fragment=o?o(u.ctx):!1,t.target){if(t.hydrate){const f=Xe(t.target);u.fragment&&u.fragment.l(f),f.forEach(S)}else u.fragment&&u.fragment.c();t.intro&&Ae(e.$$.fragment),nt(e,t.target,t.anchor),Le()}le(m)}class it{constructor(){fe(this,"$$");fe(this,"$$set")}$destroy(){ot(this,1),this.$destroy=re}$on(t,n){if(!Ee(n))return re;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(t){this.$$set&&!je(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const st="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(st);function ct(e,t,n,o){const r=ft(e),i=ut(e,t,o),s=at(e,t,n,o),d=r+(i?10:0)+(s?5:0);return{terrain:r,middleKingdom:i,harmony:s,total:d}}function ft(e){const t=e.map(r=>r.map(()=>!1));let n=0;function o(r,i,s){if(r<0||r>=e.length||i<0||i>=e[0].length||t[r][i]||e[r][i].terrain!==s)return[0,0];t[r][i]=!0;let d=1,m=e[r][i].crowns;for(const[u,_]of[[1,0],[-1,0],[0,1],[0,-1]]){const[f,h]=o(r+u,i+_,s);d+=f,m+=h}return[d,m]}for(let r=0;r<e.length;r++)for(let i=0;i<e[0].length;i++){const s=e[r][i];if(s.terrain&&!t[r][i]){const[d,m]=o(r,i,s.terrain);n+=d*m}}return n}function ut(e,t,n){const{minRow:o,maxRow:r,minCol:i,maxCol:s}=Oe(e,t),d=Math.floor((o+r)/2),m=Math.floor((i+s)/2),u=t.row===d&&t.col===m,_=r-o+1===n&&s-i+1===n;return u&&_}function at(e,t,n,o){const{minRow:r,maxRow:i,minCol:s,maxCol:d}=Oe(e,t),m=i-r+1===o&&d-s+1===o;for(let u=n.row;u<n.row+o;u++)for(let _=n.col;_<n.col+o;_++)if((u!==t.row||_!==t.col)&&e[u][_].terrain===null)return!1;return m}function Oe(e,t){let n=e.length,o=-1,r=e[0].length,i=-1;for(let s=0;s<e.length;s++)for(let d=0;d<e[0].length;d++)(e[s][d].terrain!==null||s===t.row&&d===t.col)&&(n=Math.min(n,s),o=Math.max(o,s),r=Math.min(r,d),i=Math.max(i,d));return{minRow:n,maxRow:o,minCol:r,maxCol:i}}function pe(e,t,n){const o=e.slice();return o[36]=t[n],o}function ge(e,t,n){const o=e.slice();return o[39]=t[n],o}function ye(e,t,n){const o=e.slice();return o[42]=t[n].tile,o[43]=t[n].row,o[44]=t[n].col,o[45]=t,o[46]=n,o}function be(e,t,n){const o=e.slice();return o[47]=t[n],o}function ke(e){let t,n,o;function r(){return e[18](e[47])}return{c(){t=F("button"),t.textContent=`${e[47]} 👑`,z(t,"class","svelte-1tdmq8o"),v(t,"selected",e[2]===e[47])},m(i,s){P(i,t,s),n||(o=J(t,"click",r),n=!0)},p(i,s){e=i,s[0]&4&&v(t,"selected",e[2]===e[47])},d(i){i&&S(t),n=!1,o()}}}function ve(e){let t,n=(e[42].crowns>0?e[42].crowns:"")+"",o,r,i,s,d,m;function u(){return e[19](e[42],e[43],e[44])}function _(...h){return e[20](e[42],e[43],e[44],...h)}function f(){return e[23](e[42],e[45],e[46])}return{c(){t=F("button"),o=V(n),r=U(),z(t,"data-row",i=e[43]),z(t,"data-col",s=e[44]),z(t,"class","tile svelte-1tdmq8o"),v(t,"grass",e[42].terrain==="grass"),v(t,"water",e[42].terrain==="water"),v(t,"forest",e[42].terrain==="forest"),v(t,"wheat",e[42].terrain==="wheat"),v(t,"swamp",e[42].terrain==="swamp"),v(t,"mine",e[42].terrain==="mine"),v(t,"castle",e[14](e[43],e[44]))},m(h,w){P(h,t,w),E(t,o),E(t,r),d||(m=[J(t,"click",u),J(t,"pointerdown",_),J(t,"pointermove",e[21]),J(t,"pointerup",e[22]),J(t,"dblclick",f)],d=!0)},p(h,w){e=h,w[0]&64&&n!==(n=(e[42].crowns>0?e[42].crowns:"")+"")&&ce(o,n),w[0]&64&&i!==(i=e[43])&&z(t,"data-row",i),w[0]&64&&s!==(s=e[44])&&z(t,"data-col",s),w[0]&64&&v(t,"grass",e[42].terrain==="grass"),w[0]&64&&v(t,"water",e[42].terrain==="water"),w[0]&64&&v(t,"forest",e[42].terrain==="forest"),w[0]&64&&v(t,"wheat",e[42].terrain==="wheat"),w[0]&64&&v(t,"swamp",e[42].terrain==="swamp"),w[0]&64&&v(t,"mine",e[42].terrain==="mine"),w[0]&16448&&v(t,"castle",e[14](e[43],e[44]))},d(h){h&&S(t),d=!1,oe(m)}}}function Ce(e){let t,n=G(e[39]),o=[];for(let r=0;r<n.length;r+=1)o[r]=ve(ye(e,n,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();t=Qe()},m(r,i){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(r,i);P(r,t,i)},p(r,i){if(i[0]&28480){n=G(r[39]);let s;for(s=0;s<n.length;s+=1){const d=ye(r,n,s);o[s]?o[s].p(d,i):(o[s]=ve(d),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(r){r&&S(t),ae(o,r)}}}function Me(e,t){let n,o=t[36]+"",r,i,s;function d(){return t[24](t[36])}return{key:e,first:null,c(){n=F("button"),r=V(o),z(n,"class",He(t[36])+" svelte-1tdmq8o"),v(n,"selected",t[1]===t[36]),this.first=n},m(m,u){P(m,n,u),E(n,r),i||(s=J(n,"click",d),i=!0)},p(m,u){t=m,u[0]&130&&v(n,"selected",t[1]===t[36])},d(m){m&&S(n),i=!1,s()}}}function Re(e){let t;return{c(){t=V("🏰 Middle Kingdom +10")},m(n,o){P(n,t,o)},d(n){n&&S(t)}}}function Ne(e){let t;return{c(){t=V("🎯 Harmony +5")},m(n,o){P(n,t,o)},d(n){n&&S(t)}}}function dt(e){let t,n,o,r,i,s,d,m=[],u=new Map,_,f,h,w,k,Q,C,H,T,D,L,I,B,y,M,R,j,W=G([0,1,2,3]),q=[];for(let c=0;c<4;c+=1)q[c]=ke(be(e,W,c));let X=G(e[6]),N=[];for(let c=0;c<X.length;c+=1)N[c]=Ce(ge(e,X,c));let Z=G(["empty",...e[7]]);const se=c=>c[36];for(let c=0;c<Z.length;c+=1){let p=pe(e,Z,c),l=se(p);u.set(l,m[c]=Me(l,p))}let A=e[4]&&Re(),O=e[5]&&Ne();return{c(){t=F("h1"),t.textContent="Kingdomino Scorer",n=U(),o=F("div");for(let c=0;c<4;c+=1)q[c].c();r=U(),i=F("div");for(let c=0;c<N.length;c+=1)N[c].c();s=U(),d=F("div");for(let c=0;c<m.length;c+=1)m[c].c();_=U(),f=F("p"),h=V("Total Score: "),w=F("strong"),k=V(e[3]),Q=U(),C=F("span"),A&&A.c(),H=U(),T=F("span"),O&&O.c(),D=U(),L=F("button"),I=V("Board Size: "),B=V(e[0]),y=V("×"),M=V(e[0]),Y(t,"text-align","center"),z(o,"class","crown-controls controls svelte-1tdmq8o"),z(i,"class","board svelte-1tdmq8o"),Y(i,"--board-size",e[0]),z(d,"class","controls svelte-1tdmq8o"),Y(C,"margin-left","1rem"),Y(T,"margin-left","1rem"),Y(L,"margin-left","20px"),z(L,"class","svelte-1tdmq8o"),Y(f,"text-align","center"),Y(f,"font-size","1.2rem")},m(c,p){P(c,t,p),P(c,n,p),P(c,o,p);for(let l=0;l<4;l+=1)q[l]&&q[l].m(o,null);P(c,r,p),P(c,i,p);for(let l=0;l<N.length;l+=1)N[l]&&N[l].m(i,null);P(c,s,p),P(c,d,p);for(let l=0;l<m.length;l+=1)m[l]&&m[l].m(d,null);P(c,_,p),P(c,f,p),E(f,h),E(f,w),E(w,k),E(f,Q),E(f,C),A&&A.m(C,null),E(f,H),E(f,T),O&&O.m(T,null),E(f,D),E(f,L),E(L,I),E(L,B),E(L,y),E(L,M),R||(j=J(L,"click",e[25]),R=!0)},p(c,p){if(p[0]&4){W=G([0,1,2,3]);let l;for(l=0;l<4;l+=1){const a=be(c,W,l);q[l]?q[l].p(a,p):(q[l]=ke(a),q[l].c(),q[l].m(o,null))}for(;l<4;l+=1)q[l].d(1)}if(p[0]&28480){X=G(c[6]);let l;for(l=0;l<X.length;l+=1){const a=ge(c,X,l);N[l]?N[l].p(a,p):(N[l]=Ce(a),N[l].c(),N[l].m(i,null))}for(;l<N.length;l+=1)N[l].d(1);N.length=X.length}p[0]&1&&Y(i,"--board-size",c[0]),p[0]&4226&&(Z=G(["empty",...c[7]]),m=tt(m,p,se,1,c,Z,u,d,et,Me,null,pe)),p[0]&8&&ce(k,c[3]),c[4]?A||(A=Re(),A.c(),A.m(C,null)):A&&(A.d(1),A=null),c[5]?O||(O=Ne(),O.c(),O.m(T,null)):O&&(O.d(1),O=null),p[0]&1&&ce(B,c[0]),p[0]&1&&ce(M,c[0])},i:re,o:re,d(c){c&&(S(t),S(n),S(o),S(r),S(i),S(s),S(d),S(_),S(f)),ae(q,c),ae(N,c);for(let p=0;p<m.length;p+=1)m[p].d();A&&A.d(),O&&O.d(),R=!1,j()}}}const ee=13;function mt(e,t,n){let o,r=!1,i=null,s=null;function d(){r=!1,i=null,s=null}Ye(()=>{window.addEventListener("pointerup",d),window.addEventListener("pointercancel",d)}),Ue(()=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",d)});const m=["grass","water","forest","wheat","swamp","mine"];let u=Array.from({length:ee},()=>Array.from({length:ee},()=>({terrain:null,crowns:0}))),_=7,f={row:3,col:3},h={row:6,col:6};function w(l,a,g){y(a,g)?s={row:a,col:g}:I===null&&(r=!0,i=D==="empty"?null:D,T(l,a,g))}function k(l){const a=document.elementFromPoint(l.clientX,l.clientY);if(!(a!=null&&a.dataset))return;const g=parseInt(a.dataset.row??""),$=parseInt(a.dataset.col??"");if(!(isNaN(g)||isNaN($))){if(s){const b=g-s.row,K=$-s.col;Q(h.row+b,h.col+K),s=null}r=!1,i=null}}function Q(l,a){const g=l-h.row,$=a-h.col,b={row:f.row-g,col:f.col-$},{minRow:K,maxRow:Pe,minCol:qe,maxCol:Ie}=M(),Ke=b.row,Te=b.row+_-1,De=b.col,Fe=b.col+_-1;return K>=Ke&&Pe<=Te&&qe>=De&&Ie<=Fe?(n(17,f=b),C(),!0):!1}function C(){n(16,u=[...u]);const l=ct(u,h,f,_);n(3,R=l.total),n(4,j=l.middleKingdom),n(5,W=l.harmony)}function H(l){if(!r||i===null)return;const a=document.elementFromPoint(l.clientX,l.clientY);if(!(a!=null&&a.dataset))return;const g=parseInt(a.dataset.row??""),$=parseInt(a.dataset.col??"");if(isNaN(g)||isNaN($))return;const b=u[g][$];T(b,g,$)}function T(l,a,g){y(a,g)||r&&i!==null&&(l.terrain=i,C())}let D="grass";function L(l){n(1,D=l),n(2,I=null)}let I=null;function B(l,a,g){y(a,g)||(I!==null?l.crowns=I:l.terrain=D==="empty"?null:D,C())}function y(l,a){return l===h.row&&a===h.col}function M(){let l=ee,a=-1,g=ee,$=-1;for(let b=0;b<ee;b++)for(let K=0;K<ee;K++)(u[b][K].terrain!==null||b===h.row&&K===h.col)&&(l=Math.min(l,b),a=Math.max(a,b),g=Math.min(g,K),$=Math.max($,K));return{minRow:l,maxRow:a,minCol:g,maxCol:$}}let R=0,j=!1,W=!1;function q(){if(_===5)n(0,_=7),f.row>0&&n(17,f.row-=1,f),f.col>0&&n(17,f.col-=1,f);else{const l=M();if(l.maxRow-l.minRow>=5||l.maxCol-l.minCol>=5)return;const a=l.maxRow<f.row+6?f.row+1:f.row,g=l.maxCol<f.col+6?f.col+1:f.col;n(17,f={row:a,col:g}),n(0,_=5)}C()}const X=l=>n(2,I=I===l?null:l),N=(l,a,g)=>B(l,a,g),Z=(l,a,g,$)=>w(l,a,g),se=l=>H(l),A=l=>k(l),O=(l,a,g)=>{n(6,a[g].tile.crowns=(l.crowns+1)%4,o),C()},c=l=>L(l),p=()=>q();return e.$$.update=()=>{e.$$.dirty[0]&196609&&n(6,o=Array.from({length:_},(l,a)=>Array.from({length:_},(g,$)=>{const b=f.row+a,K=f.col+$;return{tile:u[b][K],row:b,col:K}})))},[_,D,I,R,j,W,o,m,w,k,C,H,L,B,y,q,u,f,X,N,Z,se,A,O,c,p]}class ht extends it{constructor(t){super(),rt(this,t,mt,dt,Be,{},null,[-1,-1])}}new ht({target:document.body});
