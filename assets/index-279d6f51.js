var Be=Object.defineProperty;var qe=(e,t,n)=>t in e?Be(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var pe=(e,t,n)=>(qe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function fe(){}function De(e){return e()}function ve(){return Object.create(null)}function re(e){e.forEach(De)}function Pe(e){return typeof e=="function"}function Ke(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function He(e){return Object.keys(e).length===0}function Ue(e){return e??""}function I(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function A(e){e.parentNode&&e.parentNode.removeChild(e)}function ae(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function V(e){return document.createElement(e)}function q(e){return document.createTextNode(e)}function x(){return q(" ")}function Xe(){return q("")}function ee(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function j(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ye(e){return Array.from(e.childNodes)}function se(e,t){t=""+t,e.data!==t&&(e.data=t)}function te(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function R(e,t,n){e.classList.toggle(t,!!n)}let ue;function ce(e){ue=e}function ze(){if(!ue)throw new Error("Function called outside component initialization");return ue}function Ge(e){ze().$$.on_mount.push(e)}function Je(e){ze().$$.on_destroy.push(e)}const oe=[],ye=[];let le=[];const ke=[],Qe=Promise.resolve();let ge=!1;function We(){ge||(ge=!0,Qe.then(Te))}function be(e){le.push(e)}const we=new Set;let ne=0;function Te(){if(ne!==0)return;const e=ue;do{try{for(;ne<oe.length;){const t=oe[ne];ne++,ce(t),Ze(t.$$)}}catch(t){throw oe.length=0,ne=0,t}for(ce(null),oe.length=0,ne=0;ye.length;)ye.pop()();for(let t=0;t<le.length;t+=1){const n=le[t];we.has(n)||(we.add(n),n())}le.length=0}while(oe.length);for(;ke.length;)ke.pop()();ge=!1,we.clear(),ce(e)}function Ze(e){if(e.fragment!==null){e.update(),re(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(be)}}function xe(e){const t=[],n=[];le.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),le=t}const et=new Set;function Ie(e,t){e&&e.i&&(et.delete(e),e.i(t))}function H(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function tt(e,t){e.d(1),t.delete(e.key)}function nt(e,t,n,o,r,s,f,k,m,b,D,w){let d=e.length,u=s.length,v=d;const U={};for(;v--;)U[e[v].key]=v;const S=[],J=new Map,B=new Map,Q=[];for(v=u;v--;){const y=w(r,s,v),L=n(y);let C=f.get(L);C?o&&Q.push(()=>C.p(y,t)):(C=b(L,y),C.c()),J.set(L,S[v]=C),L in U&&B.set(L,Math.abs(v-U[L]))}const X=new Set,P=new Set;function z(y){Ie(y,1),y.m(k,D),f.set(y.key,y),D=y.first,u--}for(;d&&u;){const y=S[u-1],L=e[d-1],C=y.key,M=L.key;y===L?(D=y.first,d--,u--):J.has(M)?!f.has(C)||X.has(C)?z(y):P.has(M)?d--:B.get(C)>B.get(M)?(P.add(C),z(y)):(X.add(M),d--):(m(L,f),d--)}for(;d--;){const y=e[d];J.has(y.key)||m(y,f)}for(;u;)z(S[u-1]);return re(Q),S}function ot(e,t,n){const{fragment:o,after_update:r}=e.$$;o&&o.m(t,n),be(()=>{const s=e.$$.on_mount.map(De).filter(Pe);e.$$.on_destroy?e.$$.on_destroy.push(...s):re(s),e.$$.on_mount=[]}),r.forEach(be)}function lt(e,t){const n=e.$$;n.fragment!==null&&(xe(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function rt(e,t){e.$$.dirty[0]===-1&&(oe.push(e),We(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function it(e,t,n,o,r,s,f=null,k=[-1]){const m=ue;ce(e);const b=e.$$={fragment:null,ctx:[],props:s,update:fe,not_equal:r,bound:ve(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:ve(),dirty:k,skip_bound:!1,root:t.target||m.$$.root};f&&f(b.root);let D=!1;if(b.ctx=n?n(e,t.props||{},(w,d,...u)=>{const v=u.length?u[0]:d;return b.ctx&&r(b.ctx[w],b.ctx[w]=v)&&(!b.skip_bound&&b.bound[w]&&b.bound[w](v),D&&rt(e,w)),d}):[],b.update(),D=!0,re(b.before_update),b.fragment=o?o(b.ctx):!1,t.target){if(t.hydrate){const w=Ye(t.target);b.fragment&&b.fragment.l(w),w.forEach(A)}else b.fragment&&b.fragment.c();t.intro&&Ie(e.$$.fragment),ot(e,t.target,t.anchor),Te()}ce(m)}class st{constructor(){pe(this,"$$");pe(this,"$$set")}$destroy(){lt(this,1),this.$destroy=fe}$on(t,n){if(!Pe(n))return fe;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(t){this.$$set&&!He(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ct="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ct);function $e(e,t,n){const o=e.slice();return o[37]=t[n],o}function Ce(e,t,n){const o=e.slice();return o[40]=t[n],o}function Me(e,t,n){const o=e.slice();return o[43]=t[n],o}function Re(e,t,n){const o=e.slice();return o[46]=t[n].tile,o[47]=t[n].row,o[48]=t[n].col,o}function Se(e,t,n){const o=e.slice();return o[51]=t[n],o}function Ee(e){let t,n,o;function r(){return e[16](e[51])}return{c(){t=V("button"),t.textContent=`${e[51]} ðŸ‘‘`,j(t,"class","svelte-1uedvde"),R(t,"selected",e[3]===e[51])},m(s,f){N(s,t,f),n||(o=ee(t,"click",r),n=!0)},p(s,f){e=s,f[0]&8&&R(t,"selected",e[3]===e[51])},d(s){s&&A(t),n=!1,o()}}}function Oe(e){let t,n=(e[46].crowns>0?e[46].crowns:"")+"",o,r,s,f,k,m;function b(){return e[17](e[46],e[47],e[48])}function D(...d){return e[18](e[46],e[47],e[48],...d)}function w(){return e[20](e[47],e[48])}return{c(){t=V("button"),o=q(n),r=x(),j(t,"data-row",s=e[47]),j(t,"data-col",f=e[48]),j(t,"class","tile svelte-1uedvde"),R(t,"grass",e[46].terrain==="grass"),R(t,"water",e[46].terrain==="water"),R(t,"forest",e[46].terrain==="forest"),R(t,"wheat",e[46].terrain==="wheat"),R(t,"swamp",e[46].terrain==="swamp"),R(t,"mine",e[46].terrain==="mine"),R(t,"castle",e[12](e[47],e[48]))},m(d,u){N(d,t,u),I(t,o),I(t,r),k||(m=[ee(t,"click",b),ee(t,"pointerdown",D),ee(t,"pointermove",e[19]),ee(t,"pointerup",w)],k=!0)},p(d,u){e=d,u[0]&32&&n!==(n=(e[46].crowns>0?e[46].crowns:"")+"")&&se(o,n),u[0]&32&&s!==(s=e[47])&&j(t,"data-row",s),u[0]&32&&f!==(f=e[48])&&j(t,"data-col",f),u[0]&32&&R(t,"grass",e[46].terrain==="grass"),u[0]&32&&R(t,"water",e[46].terrain==="water"),u[0]&32&&R(t,"forest",e[46].terrain==="forest"),u[0]&32&&R(t,"wheat",e[46].terrain==="wheat"),u[0]&32&&R(t,"swamp",e[46].terrain==="swamp"),u[0]&32&&R(t,"mine",e[46].terrain==="mine"),u[0]&4128&&R(t,"castle",e[12](e[47],e[48]))},d(d){d&&A(t),k=!1,re(m)}}}function Ae(e){let t,n=H(e[43]),o=[];for(let r=0;r<n.length;r+=1)o[r]=Oe(Re(e,n,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();t=Xe()},m(r,s){for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(r,s);N(r,t,s)},p(r,s){if(s[0]&7072){n=H(r[43]);let f;for(f=0;f<n.length;f+=1){const k=Re(r,n,f);o[f]?o[f].p(k,s):(o[f]=Oe(k),o[f].c(),o[f].m(t.parentNode,t))}for(;f<o.length;f+=1)o[f].d(1);o.length=n.length}},d(r){r&&A(t),ae(o,r)}}}function Le(e,t){let n,o=t[40]+"",r,s,f;function k(){return t[21](t[40])}return{key:e,first:null,c(){n=V("button"),r=q(o),j(n,"class",Ue(t[40])+" svelte-1uedvde"),R(n,"selected",t[2]===t[40]),this.first=n},m(m,b){N(m,n,b),I(n,r),s||(f=ee(n,"click",k),s=!0)},p(m,b){t=m,b[0]&68&&R(n,"selected",t[2]===t[40])},d(m){m&&A(n),s=!1,f()}}}function Ne(e){let t,n=e[37]+"",o;return{c(){t=V("div"),o=q(n)},m(r,s){N(r,t,s),I(t,o)},p(r,s){s[0]&2&&n!==(n=r[37]+"")&&se(o,n)},d(r){r&&A(t)}}}function ft(e){let t,n,o,r,s,f,k,m=[],b=new Map,D,w,d,u,v,U,S,J,B,Q,X,P,z,y,L,C=H([0,1,2,3]),M=[];for(let l=0;l<4;l+=1)M[l]=Ee(Se(e,C,l));let W=H(e[5]),E=[];for(let l=0;l<W.length;l+=1)E[l]=Ae(Me(e,W,l));let Y=H(["empty",...e[6]]);const ie=l=>l[40];for(let l=0;l<Y.length;l+=1){let g=Ce(e,Y,l),i=ie(g);b.set(i,m[l]=Le(i,g))}let G=H(e[1]),O=[];for(let l=0;l<G.length;l+=1)O[l]=Ne($e(e,G,l));return{c(){t=V("h1"),t.textContent="Kingdomino Scorer",n=x(),o=V("div");for(let l=0;l<4;l+=1)M[l].c();r=x(),s=V("div");for(let l=0;l<E.length;l+=1)E[l].c();f=x(),k=V("div");for(let l=0;l<m.length;l+=1)m[l].c();D=x(),w=V("p"),d=q("Total Score: "),u=V("strong"),v=q(e[4]),U=x(),S=V("button"),J=q("Board Size: "),B=q(e[0]),Q=q("Ã—"),X=q(e[0]),P=x(),z=V("div");for(let l=0;l<O.length;l+=1)O[l].c();te(t,"text-align","center"),j(o,"class","crown-controls controls svelte-1uedvde"),j(s,"class","board svelte-1uedvde"),te(s,"grid-template-columns","repeat("+e[0]+", 1fr)"),j(k,"class","controls svelte-1uedvde"),te(S,"margin-left","20px"),j(S,"class","svelte-1uedvde"),te(w,"text-align","center"),te(w,"font-size","1.2rem"),j(z,"class","debug-log svelte-1uedvde")},m(l,g){N(l,t,g),N(l,n,g),N(l,o,g);for(let i=0;i<4;i+=1)M[i]&&M[i].m(o,null);N(l,r,g),N(l,s,g);for(let i=0;i<E.length;i+=1)E[i]&&E[i].m(s,null);N(l,f,g),N(l,k,g);for(let i=0;i<m.length;i+=1)m[i]&&m[i].m(k,null);N(l,D,g),N(l,w,g),I(w,d),I(w,u),I(u,v),I(w,U),I(w,S),I(S,J),I(S,B),I(S,Q),I(S,X),N(l,P,g),N(l,z,g);for(let i=0;i<O.length;i+=1)O[i]&&O[i].m(z,null);y||(L=ee(S,"click",e[22]),y=!0)},p(l,g){if(g[0]&8){C=H([0,1,2,3]);let i;for(i=0;i<4;i+=1){const K=Se(l,C,i);M[i]?M[i].p(K,g):(M[i]=Ee(K),M[i].c(),M[i].m(o,null))}for(;i<4;i+=1)M[i].d(1)}if(g[0]&7072){W=H(l[5]);let i;for(i=0;i<W.length;i+=1){const K=Me(l,W,i);E[i]?E[i].p(K,g):(E[i]=Ae(K),E[i].c(),E[i].m(s,null))}for(;i<E.length;i+=1)E[i].d(1);E.length=W.length}if(g[0]&1&&te(s,"grid-template-columns","repeat("+l[0]+", 1fr)"),g[0]&1092&&(Y=H(["empty",...l[6]]),m=nt(m,g,ie,1,l,Y,b,k,tt,Le,null,Ce)),g[0]&16&&se(v,l[4]),g[0]&1&&se(B,l[0]),g[0]&1&&se(X,l[0]),g[0]&2){G=H(l[1]);let i;for(i=0;i<G.length;i+=1){const K=$e(l,G,i);O[i]?O[i].p(K,g):(O[i]=Ne(K),O[i].c(),O[i].m(z,null))}for(;i<O.length;i+=1)O[i].d(1);O.length=G.length}},i:fe,o:fe,d(l){l&&(A(t),A(n),A(o),A(r),A(s),A(f),A(k),A(D),A(w),A(P),A(z)),ae(M,l),ae(E,l);for(let g=0;g<m.length;g+=1)m[g].d();ae(O,l),y=!1,L()}}}const F=13;function ut(e,t,n){let o,r=[];function s(c){n(1,r=[...r,c].slice(-10))}let f=!1,k=null,m=null;function b(){f=!1,k=null,m=null}Ge(()=>{window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)}),Je(()=>{window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b)});const D=["grass","water","forest","wheat","swamp","mine"];let w=Array.from({length:F},()=>Array.from({length:F},()=>({terrain:null,crowns:0}))),d=5,u={row:4,col:4},v={row:6,col:6};function U(c,a,h){s(`beginDrag: ${a}, ${h}`),C(a,h)?m={row:a,col:h}:(f=!0,k=P==="empty"?null:P,X(c,a,h))}function S(c,a){if(s(`endDrag: ${c}, ${a}`),m){const h=c-m.row,p=a-m.col;J(v.row+h,v.col+p),m=null}f=!1,k=null}function J(c,a){const h=c-v.row,p=a-v.col,_={row:u.row-h,col:u.col-p},{minRow:$,maxRow:T,minCol:Z,maxCol:de}=Y(),he=_.row,_e=_.row+d-1,me=_.col,je=_.col+d-1;return $>=he&&T<=_e&&Z>=me&&de<=je?(n(15,u=_),B(),!0):!1}function B(){n(14,w=[...w]),n(4,ie=E())}function Q(c){if(!f||k===null)return;const a=document.elementFromPoint(c.clientX,c.clientY);if(!(a!=null&&a.dataset))return;const h=parseInt(a.dataset.row??""),p=parseInt(a.dataset.col??"");if(isNaN(h)||isNaN(p))return;const _=w[h][p];X(_,h,p)}function X(c,a,h){s(`applyDrag: ${a}, ${h}`),!C(a,h)&&f&&k!==null&&(c.terrain=k,c.crowns=Math.floor(Math.random()*4),B())}let P="grass";function z(c){n(2,P=c)}let y=null;function L(c,a,h){C(a,h)||(c.terrain=P==="empty"?null:P,y!==null&&(c.crowns=y,n(3,y=null)),B())}function C(c,a){return c===v.row&&a===v.col}function M(){const{minRow:c,maxRow:a,minCol:h,maxCol:p}=Y(),_=Math.floor((c+a)/2),$=Math.floor((h+p)/2),T=v.row===_&&v.col===$,Z=a-c+1===d&&p-h+1===d;return T&&Z}function W(){const{minRow:c,maxRow:a,minCol:h,maxCol:p}=Y(),_=a-c+1===d&&p-h+1===d;for(let $=u.row;$<u.row+d;$++)for(let T=u.col;T<u.col+d;T++)if(($!==v.row||T!==v.col)&&w[$][T].terrain===null)return!1;return _}function E(){const c=Array.from({length:F},()=>Array(F).fill(!1));let a=0;function h(p,_,$){if(p<0||p>=F||_<0||_>=F||c[p][_]||w[p][_].terrain!==$)return[0,0];c[p][_]=!0;let T=1,Z=w[p][_].crowns;for(const[de,he]of[[1,0],[-1,0],[0,1],[0,-1]]){const[_e,me]=h(p+de,_+he,$);T+=_e,Z+=me}return[T,Z]}for(let p=0;p<F;p++)for(let _=0;_<F;_++){const $=w[p][_];if($.terrain&&!c[p][_]){const[T,Z]=h(p,_,$.terrain);a+=T*Z}}return a+=M()?10:0,a+=W()?5:0,a}function Y(){let c=F,a=-1,h=F,p=-1;for(let _=0;_<F;_++)for(let $=0;$<F;$++)(w[_][$].terrain!==null||_===v.row&&$===v.col)&&(c=Math.min(c,_),a=Math.max(a,_),h=Math.min(h,$),p=Math.max(p,$));return{minRow:c,maxRow:a,minCol:h,maxCol:p}}let ie=0;function G(){if(d===5)n(0,d=7),u.row>0&&n(15,u.row-=1,u),u.col>0&&n(15,u.col-=1,u);else{const c=Y();if(c.maxRow-c.minRow>=5||c.maxCol-c.minCol>=5)return;const a=c.maxRow<u.row+6?u.row+1:u.row,h=c.maxCol<u.col+6?u.col+1:u.col;n(15,u={row:a,col:h}),n(0,d=5)}}const O=c=>n(3,y=c),l=(c,a,h)=>L(c,a,h),g=(c,a,h,p)=>U(c,a,h),i=c=>Q(c),K=(c,a)=>S(c,a),Fe=c=>z(c),Ve=()=>G();return e.$$.update=()=>{e.$$.dirty[0]&49153&&n(5,o=Array.from({length:d},(c,a)=>Array.from({length:d},(h,p)=>{const _=u.row+a,$=u.col+p;return{tile:w[_][$],row:_,col:$}})))},[d,r,P,y,ie,o,D,U,S,Q,z,L,C,G,w,u,O,l,g,i,K,Fe,Ve]}class at extends st{constructor(t){super(),it(this,t,ut,ft,Ke,{},null,[-1,-1])}}new at({target:document.body});
