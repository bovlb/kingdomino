var Fe=Object.defineProperty;var Ve=(e,t,n)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ce=(e,t,n)=>(Ve(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const c of r.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();function le(){}function Re(e){return e()}function me(){return Object.create(null)}function ne(e){e.forEach(Re)}function Se(e){return typeof e=="function"}function Be(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function je(e){return Object.keys(e).length===0}function qe(e){return e??""}function R(e,t){e.appendChild(t)}function A(e,t,n){e.insertBefore(t,n||null)}function S(e){e.parentNode&&e.parentNode.removeChild(e)}function ue(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function z(e){return document.createElement(e)}function F(e){return document.createTextNode(e)}function Y(){return F(" ")}function He(){return F("")}function G(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function V(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Qe(e){return Array.from(e.childNodes)}function se(e,t){t=""+t,e.data!==t&&(e.data=t)}function X(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function b(e,t,n){e.classList.toggle(t,!!n)}let re;function oe(e){re=e}function Ne(){if(!re)throw new Error("Function called outside component initialization");return re}function Xe(e){Ne().$$.on_mount.push(e)}function Ye(e){Ne().$$.on_destroy.push(e)}const ee=[],he=[];let te=[];const _e=[],Ue=Promise.resolve();let ae=!1;function Ge(){ae||(ae=!0,Ue.then(Ee))}function de(e){te.push(e)}const fe=new Set;let Z=0;function Ee(){if(Z!==0)return;const e=re;do{try{for(;Z<ee.length;){const t=ee[Z];Z++,oe(t),Je(t.$$)}}catch(t){throw ee.length=0,Z=0,t}for(oe(null),ee.length=0,Z=0;he.length;)he.pop()();for(let t=0;t<te.length;t+=1){const n=te[t];fe.has(n)||(fe.add(n),n())}te.length=0}while(ee.length);for(;_e.length;)_e.pop()();ae=!1,fe.clear(),oe(e)}function Je(e){if(e.fragment!==null){e.update(),ne(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(de)}}function We(e){const t=[],n=[];te.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),te=t}const Ze=new Set;function Le(e,t){e&&e.i&&(Ze.delete(e),e.i(t))}function U(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function xe(e,t){e.d(1),t.delete(e.key)}function et(e,t,n,o,l,r,c,d,h,a,p,u){let m=e.length,v=r.length,y=m;const H={};for(;y--;)H[e[y].key]=y;const O=[],q=new Map,K=new Map,D=[];for(y=v;y--;){const w=u(l,r,y),k=n(w);let C=c.get(k);C?o&&D.push(()=>C.p(w,t)):(C=a(k,w),C.c()),q.set(k,O[y]=C),k in H&&K.set(k,Math.abs(y-H[k]))}const N=new Set,T=new Set;function B(w){Le(w,1),w.m(d,p),c.set(w.key,w),p=w.first,v--}for(;m&&v;){const w=O[v-1],k=e[m-1],C=w.key,j=k.key;w===k?(p=w.first,m--,v--):q.has(j)?!c.has(C)||N.has(C)?B(w):T.has(j)?m--:K.get(C)>K.get(j)?(T.add(C),B(w)):(N.add(j),m--):(h(k,c),m--)}for(;m--;){const w=e[m];q.has(w.key)||h(w,c)}for(;v;)B(O[v-1]);return ne(D),O}function tt(e,t,n){const{fragment:o,after_update:l}=e.$$;o&&o.m(t,n),de(()=>{const r=e.$$.on_mount.map(Re).filter(Se);e.$$.on_destroy?e.$$.on_destroy.push(...r):ne(r),e.$$.on_mount=[]}),l.forEach(de)}function nt(e,t){const n=e.$$;n.fragment!==null&&(We(n.after_update),ne(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ot(e,t){e.$$.dirty[0]===-1&&(ee.push(e),Ge(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function lt(e,t,n,o,l,r,c=null,d=[-1]){const h=re;oe(e);const a=e.$$={fragment:null,ctx:[],props:r,update:le,not_equal:l,bound:me(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(h?h.$$.context:[])),callbacks:me(),dirty:d,skip_bound:!1,root:t.target||h.$$.root};c&&c(a.root);let p=!1;if(a.ctx=n?n(e,t.props||{},(u,m,...v)=>{const y=v.length?v[0]:m;return a.ctx&&l(a.ctx[u],a.ctx[u]=y)&&(!a.skip_bound&&a.bound[u]&&a.bound[u](y),p&&ot(e,u)),m}):[],a.update(),p=!0,ne(a.before_update),a.fragment=o?o(a.ctx):!1,t.target){if(t.hydrate){const u=Qe(t.target);a.fragment&&a.fragment.l(u),u.forEach(S)}else a.fragment&&a.fragment.c();t.intro&&Le(e.$$.fragment),tt(e,t.target,t.anchor),Ee()}oe(h)}class rt{constructor(){ce(this,"$$");ce(this,"$$set")}$destroy(){nt(this,1),this.$destroy=le}$on(t,n){if(!Se(n))return le;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}$set(t){this.$$set&&!je(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const it="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(it);function st(e,t,n,o){const l=ct(e),r=ft(e,t),c=ut(e,t,n,o),d=l+(r?10:0)+(c?5:0);return{terrain:l,middleKingdom:r,harmony:c,total:d}}function ct(e){const t=e.map(l=>l.map(()=>!1));let n=0;function o(l,r,c){if(l<0||l>=e.length||r<0||r>=e[0].length||t[l][r]||e[l][r].terrain!==c)return[0,0];t[l][r]=!0;let d=1,h=e[l][r].crowns;for(const[a,p]of[[1,0],[-1,0],[0,1],[0,-1]]){const[u,m]=o(l+a,r+p,c);d+=u,h+=m}return[d,h]}for(let l=0;l<e.length;l++)for(let r=0;r<e[0].length;r++){const c=e[l][r];if(c.terrain&&!t[l][r]){const[d,h]=o(l,r,c.terrain);n+=d*h}}return n}function ft(e,t){const{minRow:n,maxRow:o,minCol:l,maxCol:r}=Ae(e,t),c=Math.floor((n+o)/2),d=Math.floor((l+r)/2),h=t.row===c&&t.col===d,a=o-n+1===5&&r-l+1===5;return h&&a}function ut(e,t,n,o){const{minRow:l,maxRow:r,minCol:c,maxCol:d}=Ae(e,t),h=r-l+1===o&&d-c+1===o;for(let a=n.row;a<n.row+o;a++)for(let p=n.col;p<n.col+o;p++)if((a!==t.row||p!==t.col)&&e[a][p].terrain===null)return!1;return h}function Ae(e,t){let n=e.length,o=-1,l=e[0].length,r=-1;for(let c=0;c<e.length;c++)for(let d=0;d<e[0].length;d++)(e[c][d].terrain!==null||c===t.row&&d===t.col)&&(n=Math.min(n,c),o=Math.max(o,c),l=Math.min(l,d),r=Math.max(r,d));return{minRow:n,maxRow:o,minCol:l,maxCol:r}}function pe(e,t,n){const o=e.slice();return o[35]=t[n],o}function we(e,t,n){const o=e.slice();return o[38]=t[n],o}function ge(e,t,n){const o=e.slice();return o[41]=t[n].tile,o[42]=t[n].row,o[43]=t[n].col,o}function ye(e,t,n){const o=e.slice();return o[46]=t[n],o}function be(e){let t,n,o;function l(){return e[17](e[46])}return{c(){t=z("button"),t.textContent=`${e[46]} 👑`,V(t,"class","svelte-1p6di0"),b(t,"selected",e[2]===e[46])},m(r,c){A(r,t,c),n||(o=G(t,"click",l),n=!0)},p(r,c){e=r,c[0]&4&&b(t,"selected",e[2]===e[46])},d(r){r&&S(t),n=!1,o()}}}function ve(e){let t,n=(e[41].crowns>0?e[41].crowns:"")+"",o,l,r,c,d,h;function a(){return e[18](e[41],e[42],e[43])}function p(...u){return e[19](e[41],e[42],e[43],...u)}return{c(){t=z("button"),o=F(n),l=Y(),V(t,"data-row",r=e[42]),V(t,"data-col",c=e[43]),V(t,"class","tile svelte-1p6di0"),b(t,"grass",e[41].terrain==="grass"),b(t,"water",e[41].terrain==="water"),b(t,"forest",e[41].terrain==="forest"),b(t,"wheat",e[41].terrain==="wheat"),b(t,"swamp",e[41].terrain==="swamp"),b(t,"mine",e[41].terrain==="mine"),b(t,"castle",e[13](e[42],e[43]))},m(u,m){A(u,t,m),R(t,o),R(t,l),d||(h=[G(t,"click",a),G(t,"pointerdown",p),G(t,"pointermove",e[20]),G(t,"pointerup",e[21])],d=!0)},p(u,m){e=u,m[0]&64&&n!==(n=(e[41].crowns>0?e[41].crowns:"")+"")&&se(o,n),m[0]&64&&r!==(r=e[42])&&V(t,"data-row",r),m[0]&64&&c!==(c=e[43])&&V(t,"data-col",c),m[0]&64&&b(t,"grass",e[41].terrain==="grass"),m[0]&64&&b(t,"water",e[41].terrain==="water"),m[0]&64&&b(t,"forest",e[41].terrain==="forest"),m[0]&64&&b(t,"wheat",e[41].terrain==="wheat"),m[0]&64&&b(t,"swamp",e[41].terrain==="swamp"),m[0]&64&&b(t,"mine",e[41].terrain==="mine"),m[0]&8256&&b(t,"castle",e[13](e[42],e[43]))},d(u){u&&S(t),d=!1,ne(h)}}}function ke(e){let t,n=U(e[38]),o=[];for(let l=0;l<n.length;l+=1)o[l]=ve(ge(e,n,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();t=He()},m(l,r){for(let c=0;c<o.length;c+=1)o[c]&&o[c].m(l,r);A(l,t,r)},p(l,r){if(r[0]&14144){n=U(l[38]);let c;for(c=0;c<n.length;c+=1){const d=ge(l,n,c);o[c]?o[c].p(d,r):(o[c]=ve(d),o[c].c(),o[c].m(t.parentNode,t))}for(;c<o.length;c+=1)o[c].d(1);o.length=n.length}},d(l){l&&S(t),ue(o,l)}}}function Ce(e,t){let n,o=t[35]+"",l,r,c;function d(){return t[22](t[35])}return{key:e,first:null,c(){n=z("button"),l=F(o),V(n,"class",qe(t[35])+" svelte-1p6di0"),b(n,"selected",t[1]===t[35]),this.first=n},m(h,a){A(h,n,a),R(n,l),r||(c=G(n,"click",d),r=!0)},p(h,a){t=h,a[0]&130&&b(n,"selected",t[1]===t[35])},d(h){h&&S(n),r=!1,c()}}}function Me(e){let t;return{c(){t=F("🏰 Middle Kingdom +10")},m(n,o){A(n,t,o)},d(n){n&&S(t)}}}function $e(e){let t;return{c(){t=F("🎯 Harmony +5")},m(n,o){A(n,t,o)},d(n){n&&S(t)}}}function at(e){let t,n,o,l,r,c,d,h=[],a=new Map,p,u,m,v,y,H,O,q,K,D,N,T,B,w,k,C,j,J=U([0,1,2,3]),P=[];for(let f=0;f<4;f+=1)P[f]=be(ye(e,J,f));let Q=U(e[6]),M=[];for(let f=0;f<Q.length;f+=1)M[f]=ke(we(e,Q,f));let W=U(["empty",...e[7]]);const ie=f=>f[35];for(let f=0;f<W.length;f+=1){let s=pe(e,W,f),i=ie(s);a.set(i,h[f]=Ce(i,s))}let E=e[4]&&Me(),L=e[5]&&$e();return{c(){t=z("h1"),t.textContent="Kingdomino Scorer",n=Y(),o=z("div");for(let f=0;f<4;f+=1)P[f].c();l=Y(),r=z("div");for(let f=0;f<M.length;f+=1)M[f].c();c=Y(),d=z("div");for(let f=0;f<h.length;f+=1)h[f].c();p=Y(),u=z("p"),m=F("Total Score: "),v=z("strong"),y=F(e[3]),H=Y(),O=z("span"),E&&E.c(),q=Y(),K=z("span"),L&&L.c(),D=Y(),N=z("button"),T=F("Board Size: "),B=F(e[0]),w=F("×"),k=F(e[0]),X(t,"text-align","center"),V(o,"class","crown-controls controls svelte-1p6di0"),V(r,"class","board svelte-1p6di0"),X(r,"--board-size",e[0]),V(d,"class","controls svelte-1p6di0"),X(O,"margin-left","1rem"),X(K,"margin-left","1rem"),X(N,"margin-left","20px"),V(N,"class","svelte-1p6di0"),X(u,"text-align","center"),X(u,"font-size","1.2rem")},m(f,s){A(f,t,s),A(f,n,s),A(f,o,s);for(let i=0;i<4;i+=1)P[i]&&P[i].m(o,null);A(f,l,s),A(f,r,s);for(let i=0;i<M.length;i+=1)M[i]&&M[i].m(r,null);A(f,c,s),A(f,d,s);for(let i=0;i<h.length;i+=1)h[i]&&h[i].m(d,null);A(f,p,s),A(f,u,s),R(u,m),R(u,v),R(v,y),R(u,H),R(u,O),E&&E.m(O,null),R(u,q),R(u,K),L&&L.m(K,null),R(u,D),R(u,N),R(N,T),R(N,B),R(N,w),R(N,k),C||(j=G(N,"click",e[23]),C=!0)},p(f,s){if(s[0]&4){J=U([0,1,2,3]);let i;for(i=0;i<4;i+=1){const _=ye(f,J,i);P[i]?P[i].p(_,s):(P[i]=be(_),P[i].c(),P[i].m(o,null))}for(;i<4;i+=1)P[i].d(1)}if(s[0]&14144){Q=U(f[6]);let i;for(i=0;i<Q.length;i+=1){const _=we(f,Q,i);M[i]?M[i].p(_,s):(M[i]=ke(_),M[i].c(),M[i].m(r,null))}for(;i<M.length;i+=1)M[i].d(1);M.length=Q.length}s[0]&1&&X(r,"--board-size",f[0]),s[0]&2178&&(W=U(["empty",...f[7]]),h=et(h,s,ie,1,f,W,a,d,xe,Ce,null,pe)),s[0]&8&&se(y,f[3]),f[4]?E||(E=Me(),E.c(),E.m(O,null)):E&&(E.d(1),E=null),f[5]?L||(L=$e(),L.c(),L.m(K,null)):L&&(L.d(1),L=null),s[0]&1&&se(B,f[0]),s[0]&1&&se(k,f[0])},i:le,o:le,d(f){f&&(S(t),S(n),S(o),S(l),S(r),S(c),S(d),S(p),S(u)),ue(P,f),ue(M,f);for(let s=0;s<h.length;s+=1)h[s].d();E&&E.d(),L&&L.d(),C=!1,j()}}}const x=13;function dt(e,t,n){let o,l=!1,r=null,c=null;function d(){l=!1,r=null,c=null}Xe(()=>{window.addEventListener("pointerup",d),window.addEventListener("pointercancel",d)}),Ye(()=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",d)});const h=["grass","water","forest","wheat","swamp","mine"];let a=Array.from({length:x},()=>Array.from({length:x},()=>({terrain:null,crowns:0}))),p=5,u={row:4,col:4},m={row:6,col:6};function v(s,i,_){w(i,_)?c={row:i,col:_}:T===null&&(l=!0,r=D==="empty"?null:D,K(s,i,_))}function y(s){const i=document.elementFromPoint(s.clientX,s.clientY);if(!(i!=null&&i.dataset))return;const _=parseInt(i.dataset.row??""),$=parseInt(i.dataset.col??"");if(!(isNaN(_)||isNaN($))){if(c){const g=_-c.row,I=$-c.col;H(m.row+g,m.col+I),c=null}l=!1,r=null}}function H(s,i){const _=s-m.row,$=i-m.col,g={row:u.row-_,col:u.col-$},{minRow:I,maxRow:Oe,minCol:Pe,maxCol:De}=k(),Ie=g.row,Ke=g.row+p-1,Te=g.col,ze=g.col+p-1;return I>=Ie&&Oe<=Ke&&Pe>=Te&&De<=ze?(n(16,u=g),O(),!0):!1}function O(){n(15,a=[...a]);const s=st(a,m,u,p);n(3,C=s.total),n(4,j=s.middleKingdom),n(5,J=s.harmony)}function q(s){if(!l||r===null)return;const i=document.elementFromPoint(s.clientX,s.clientY);if(!(i!=null&&i.dataset))return;const _=parseInt(i.dataset.row??""),$=parseInt(i.dataset.col??"");if(isNaN(_)||isNaN($))return;const g=a[_][$];K(g,_,$)}function K(s,i,_){w(i,_)||l&&r!==null&&(console.log("applyDrag: terrain",r),s.terrain=r,O())}let D="grass";function N(s){n(1,D=s)}let T=null;function B(s,i,_){w(i,_)||(T!==null?(console.log("applySelection: crown",T),s.crowns=T):(console.log("applySelection: terrain",D),s.terrain=D==="empty"?null:D),O())}function w(s,i){return s===m.row&&i===m.col}function k(){let s=x,i=-1,_=x,$=-1;for(let g=0;g<x;g++)for(let I=0;I<x;I++)(a[g][I].terrain!==null||g===m.row&&I===m.col)&&(s=Math.min(s,g),i=Math.max(i,g),_=Math.min(_,I),$=Math.max($,I));return{minRow:s,maxRow:i,minCol:_,maxCol:$}}let C=0,j=!1,J=!1;function P(){if(p===5)n(0,p=7),u.row>0&&n(16,u.row-=1,u),u.col>0&&n(16,u.col-=1,u);else{const s=k();if(s.maxRow-s.minRow>=5||s.maxCol-s.minCol>=5)return;const i=s.maxRow<u.row+6?u.row+1:u.row,_=s.maxCol<u.col+6?u.col+1:u.col;n(16,u={row:i,col:_}),n(0,p=5)}}const Q=s=>n(2,T=s),M=(s,i,_)=>B(s,i,_),W=(s,i,_,$)=>v(s,i,_),ie=s=>q(s),E=s=>y(s),L=s=>N(s),f=()=>P();return e.$$.update=()=>{e.$$.dirty[0]&98305&&n(6,o=Array.from({length:p},(s,i)=>Array.from({length:p},(_,$)=>{const g=u.row+i,I=u.col+$;return{tile:a[g][I],row:g,col:I}})))},[p,D,T,C,j,J,o,h,v,y,q,N,B,w,P,a,u,Q,M,W,ie,E,L,f]}class mt extends rt{constructor(t){super(),lt(this,t,dt,at,Be,{},null,[-1,-1])}}new mt({target:document.body});
