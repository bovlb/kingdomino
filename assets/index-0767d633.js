var Te=Object.defineProperty;var Fe=(e,t,n)=>t in e?Te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ae=(e,t,n)=>(Fe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const r of l)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&o(s)}).observe(document,{childList:!0,subtree:!0});function n(l){const r={};return l.integrity&&(r.integrity=l.integrity),l.referrerPolicy&&(r.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?r.credentials="include":l.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(l){if(l.ep)return;l.ep=!0;const r=n(l);fetch(l.href,r)}})();function le(){}function Re(e){return e()}function me(){return Object.create(null)}function te(e){e.forEach(Re)}function Ne(e){return typeof e=="function"}function Ve(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function je(e){return Object.keys(e).length===0}function Be(e){return e??""}function I(e,t){e.appendChild(t)}function z(e,t,n){e.insertBefore(t,n||null)}function A(e){e.parentNode&&e.parentNode.removeChild(e)}function he(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function V(e){return document.createElement(e)}function j(e){return document.createTextNode(e)}function Z(){return j(" ")}function qe(){return j("")}function J(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function T(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Ke(e){return Array.from(e.childNodes)}function ie(e,t){t=""+t,e.data!==t&&(e.data=t)}function Q(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function N(e,t,n){e.classList.toggle(t,!!n)}let re;function oe(e){re=e}function Ee(){if(!re)throw new Error("Function called outside component initialization");return re}function Xe(e){Ee().$$.on_mount.push(e)}function Ye(e){Ee().$$.on_destroy.push(e)}const x=[],we=[];let ee=[];const ge=[],He=Promise.resolve();let _e=!1;function Ue(){_e||(_e=!0,He.then(Oe))}function pe(e){ee.push(e)}const de=new Set;let W=0;function Oe(){if(W!==0)return;const e=re;do{try{for(;W<x.length;){const t=x[W];W++,oe(t),Ge(t.$$)}}catch(t){throw x.length=0,W=0,t}for(oe(null),x.length=0,W=0;we.length;)we.pop()();for(let t=0;t<ee.length;t+=1){const n=ee[t];de.has(n)||(de.add(n),n())}ee.length=0}while(x.length);for(;ge.length;)ge.pop()();_e=!1,de.clear(),oe(e)}function Ge(e){if(e.fragment!==null){e.update(),te(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(pe)}}function Je(e){const t=[],n=[];ee.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),ee=t}const Qe=new Set;function Ae(e,t){e&&e.i&&(Qe.delete(e),e.i(t))}function U(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function We(e,t){e.d(1),t.delete(e.key)}function Ze(e,t,n,o,l,r,s,k,w,h,b,c){let d=e.length,E=r.length,S=d;const Y={};for(;S--;)Y[e[S].key]=S;const R=[],B=new Map,F=new Map,L=[];for(S=E;S--;){const y=c(l,r,S),C=n(y);let M=s.get(C);M?o&&L.push(()=>M.p(y,t)):(M=h(C,y),M.c()),B.set(C,R[S]=M),C in Y&&F.set(C,Math.abs(S-Y[C]))}const q=new Set,O=new Set;function K(y){Ae(y,1),y.m(k,b),s.set(y.key,y),b=y.first,E--}for(;d&&E;){const y=R[E-1],C=e[d-1],M=y.key,$=C.key;y===C?(b=y.first,d--,E--):B.has($)?!s.has(M)||q.has(M)?K(y):O.has($)?d--:F.get(M)>F.get($)?(O.add(M),K(y)):(q.add($),d--):(w(C,s),d--)}for(;d--;){const y=e[d];B.has(y.key)||w(y,s)}for(;E;)K(R[E-1]);return te(L),R}function xe(e,t,n){const{fragment:o,after_update:l}=e.$$;o&&o.m(t,n),pe(()=>{const r=e.$$.on_mount.map(Re).filter(Ne);e.$$.on_destroy?e.$$.on_destroy.push(...r):te(r),e.$$.on_mount=[]}),l.forEach(pe)}function et(e,t){const n=e.$$;n.fragment!==null&&(Je(n.after_update),te(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function tt(e,t){e.$$.dirty[0]===-1&&(x.push(e),Ue(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function nt(e,t,n,o,l,r,s=null,k=[-1]){const w=re;oe(e);const h=e.$$={fragment:null,ctx:[],props:r,update:le,not_equal:l,bound:me(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(w?w.$$.context:[])),callbacks:me(),dirty:k,skip_bound:!1,root:t.target||w.$$.root};s&&s(h.root);let b=!1;if(h.ctx=n?n(e,t.props||{},(c,d,...E)=>{const S=E.length?E[0]:d;return h.ctx&&l(h.ctx[c],h.ctx[c]=S)&&(!h.skip_bound&&h.bound[c]&&h.bound[c](S),b&&tt(e,c)),d}):[],h.update(),b=!0,te(h.before_update),h.fragment=o?o(h.ctx):!1,t.target){if(t.hydrate){const c=Ke(t.target);h.fragment&&h.fragment.l(c),c.forEach(A)}else h.fragment&&h.fragment.c();t.intro&&Ae(e.$$.fragment),xe(e,t.target,t.anchor),Oe()}oe(w)}class ot{constructor(){ae(this,"$$");ae(this,"$$set")}$destroy(){et(this,1),this.$destroy=le}$on(t,n){if(!Ne(n))return le;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const l=o.indexOf(n);l!==-1&&o.splice(l,1)}}$set(t){this.$$set&&!je(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const lt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(lt);function be(e,t,n){const o=e.slice();return o[36]=t[n],o}function ye(e,t,n){const o=e.slice();return o[39]=t[n],o}function ve(e,t,n){const o=e.slice();return o[42]=t[n].tile,o[43]=t[n].row,o[44]=t[n].col,o}function ke(e,t,n){const o=e.slice();return o[47]=t[n],o}function Ce(e){let t,n,o;function l(){return e[15](e[47])}return{c(){t=V("button"),t.textContent=`${e[47]} ðŸ‘‘`,T(t,"class","svelte-5g6d06"),N(t,"selected",e[2]===e[47])},m(r,s){z(r,t,s),n||(o=J(t,"click",l),n=!0)},p(r,s){e=r,s[0]&4&&N(t,"selected",e[2]===e[47])},d(r){r&&A(t),n=!1,o()}}}function $e(e){let t,n=(e[42].crowns>0?e[42].crowns:"")+"",o,l,r,s,k,w;function h(){return e[16](e[42],e[43],e[44])}function b(...c){return e[17](e[42],e[43],e[44],...c)}return{c(){t=V("button"),o=j(n),l=Z(),T(t,"data-row",r=e[43]),T(t,"data-col",s=e[44]),T(t,"class","tile svelte-5g6d06"),N(t,"grass",e[42].terrain==="grass"),N(t,"water",e[42].terrain==="water"),N(t,"forest",e[42].terrain==="forest"),N(t,"wheat",e[42].terrain==="wheat"),N(t,"swamp",e[42].terrain==="swamp"),N(t,"mine",e[42].terrain==="mine"),N(t,"castle",e[11](e[43],e[44]))},m(c,d){z(c,t,d),I(t,o),I(t,l),k||(w=[J(t,"click",h),J(t,"pointerdown",b),J(t,"pointermove",e[18]),J(t,"pointerup",e[19])],k=!0)},p(c,d){e=c,d[0]&16&&n!==(n=(e[42].crowns>0?e[42].crowns:"")+"")&&ie(o,n),d[0]&16&&r!==(r=e[43])&&T(t,"data-row",r),d[0]&16&&s!==(s=e[44])&&T(t,"data-col",s),d[0]&16&&N(t,"grass",e[42].terrain==="grass"),d[0]&16&&N(t,"water",e[42].terrain==="water"),d[0]&16&&N(t,"forest",e[42].terrain==="forest"),d[0]&16&&N(t,"wheat",e[42].terrain==="wheat"),d[0]&16&&N(t,"swamp",e[42].terrain==="swamp"),d[0]&16&&N(t,"mine",e[42].terrain==="mine"),d[0]&2064&&N(t,"castle",e[11](e[43],e[44]))},d(c){c&&A(t),k=!1,te(w)}}}function Me(e){let t,n=U(e[39]),o=[];for(let l=0;l<n.length;l+=1)o[l]=$e(ve(e,n,l));return{c(){for(let l=0;l<o.length;l+=1)o[l].c();t=qe()},m(l,r){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(l,r);z(l,t,r)},p(l,r){if(r[0]&3536){n=U(l[39]);let s;for(s=0;s<n.length;s+=1){const k=ve(l,n,s);o[s]?o[s].p(k,r):(o[s]=$e(k),o[s].c(),o[s].m(t.parentNode,t))}for(;s<o.length;s+=1)o[s].d(1);o.length=n.length}},d(l){l&&A(t),he(o,l)}}}function Se(e,t){let n,o=t[36]+"",l,r,s;function k(){return t[20](t[36])}return{key:e,first:null,c(){n=V("button"),l=j(o),T(n,"class",Be(t[36])+" svelte-5g6d06"),N(n,"selected",t[1]===t[36]),this.first=n},m(w,h){z(w,n,h),I(n,l),r||(s=J(n,"click",k),r=!0)},p(w,h){t=w,h[0]&34&&N(n,"selected",t[1]===t[36])},d(w){w&&A(n),r=!1,s()}}}function rt(e){let t,n,o,l,r,s,k,w=[],h=new Map,b,c,d,E,S,Y,R,B,F,L,q,O,K,y=U([0,1,2,3]),C=[];for(let i=0;i<4;i+=1)C[i]=Ce(ke(e,y,i));let M=U(e[4]),$=[];for(let i=0;i<M.length;i+=1)$[i]=Me(ye(e,M,i));let X=U(["empty",...e[5]]);const ne=i=>i[36];for(let i=0;i<X.length;i+=1){let g=be(e,X,i),u=ne(g);h.set(u,w[i]=Se(u,g))}return{c(){t=V("h1"),t.textContent="Kingdomino Scorer",n=Z(),o=V("div");for(let i=0;i<4;i+=1)C[i].c();l=Z(),r=V("div");for(let i=0;i<$.length;i+=1)$[i].c();s=Z(),k=V("div");for(let i=0;i<w.length;i+=1)w[i].c();b=Z(),c=V("p"),d=j("Total Score: "),E=V("strong"),S=j(e[3]),Y=Z(),R=V("button"),B=j("Board Size: "),F=j(e[0]),L=j("Ã—"),q=j(e[0]),Q(t,"text-align","center"),T(o,"class","crown-controls controls svelte-5g6d06"),T(r,"class","board svelte-5g6d06"),Q(r,"--board-size",e[0]),T(k,"class","controls svelte-5g6d06"),Q(R,"margin-left","20px"),T(R,"class","svelte-5g6d06"),Q(c,"text-align","center"),Q(c,"font-size","1.2rem")},m(i,g){z(i,t,g),z(i,n,g),z(i,o,g);for(let u=0;u<4;u+=1)C[u]&&C[u].m(o,null);z(i,l,g),z(i,r,g);for(let u=0;u<$.length;u+=1)$[u]&&$[u].m(r,null);z(i,s,g),z(i,k,g);for(let u=0;u<w.length;u+=1)w[u]&&w[u].m(k,null);z(i,b,g),z(i,c,g),I(c,d),I(c,E),I(E,S),I(c,Y),I(c,R),I(R,B),I(R,F),I(R,L),I(R,q),O||(K=J(R,"click",e[21]),O=!0)},p(i,g){if(g[0]&4){y=U([0,1,2,3]);let u;for(u=0;u<4;u+=1){const G=ke(i,y,u);C[u]?C[u].p(G,g):(C[u]=Ce(G),C[u].c(),C[u].m(o,null))}for(;u<4;u+=1)C[u].d(1)}if(g[0]&3536){M=U(i[4]);let u;for(u=0;u<M.length;u+=1){const G=ye(i,M,u);$[u]?$[u].p(G,g):($[u]=Me(G),$[u].c(),$[u].m(r,null))}for(;u<$.length;u+=1)$[u].d(1);$.length=M.length}g[0]&1&&Q(r,"--board-size",i[0]),g[0]&546&&(X=U(["empty",...i[5]]),w=Ze(w,g,ne,1,i,X,h,k,We,Se,null,be)),g[0]&8&&ie(S,i[3]),g[0]&1&&ie(F,i[0]),g[0]&1&&ie(q,i[0])},i:le,o:le,d(i){i&&(A(t),A(n),A(o),A(l),A(r),A(s),A(k),A(b),A(c)),he(C,i),he($,i);for(let g=0;g<w.length;g+=1)w[g].d();O=!1,K()}}}const D=13;function it(e,t,n){let o,l=!1,r=null,s=null;function k(){l=!1,r=null,s=null}Xe(()=>{window.addEventListener("pointerup",k),window.addEventListener("pointercancel",k)}),Ye(()=>{window.removeEventListener("pointerup",k),window.removeEventListener("pointercancel",k)});const w=["grass","water","forest","wheat","swamp","mine"];let h=Array.from({length:D},()=>Array.from({length:D},()=>({terrain:null,crowns:0}))),b=5,c={row:4,col:4},d={row:6,col:6};function E(f,a,p){y(a,p)?s={row:a,col:p}:O===null&&(l=!0,r=L==="empty"?null:L,F(f,a,p))}function S(f){const a=document.elementFromPoint(f.clientX,f.clientY);if(!(a!=null&&a.dataset))return;const p=parseInt(a.dataset.row??""),m=parseInt(a.dataset.col??"");if(!(isNaN(p)||isNaN(m))){if(s){const _=p-s.row,v=m-s.col;Y(d.row+_,d.col+v),s=null}l=!1,r=null}}function Y(f,a){const p=f-d.row,m=a-d.col,_={row:c.row-p,col:c.col-m},{minRow:v,maxRow:P,minCol:H,maxCol:se}=X(),ce=_.row,fe=_.row+b-1,ue=_.col,Ie=_.col+b-1;return v>=ce&&P<=fe&&H>=ue&&se<=Ie?(n(14,c=_),R(),!0):!1}function R(){n(13,h=[...h]),n(3,ne=$())}function B(f){if(!l||r===null)return;const a=document.elementFromPoint(f.clientX,f.clientY);if(!(a!=null&&a.dataset))return;const p=parseInt(a.dataset.row??""),m=parseInt(a.dataset.col??"");if(isNaN(p)||isNaN(m))return;const _=h[p][m];F(_,p,m)}function F(f,a,p){y(a,p)||l&&r!==null&&(console.log("applyDrag: terrain",r),f.terrain=r,R())}let L="grass";function q(f){n(1,L=f)}let O=null;function K(f,a,p){y(a,p)||(O!==null?(console.log("applySelection: crown",O),f.crowns=O,n(2,O=null)):(console.log("applySelection: terrain",L),f.terrain=L==="empty"?null:L),R())}function y(f,a){return f===d.row&&a===d.col}function C(){const{minRow:f,maxRow:a,minCol:p,maxCol:m}=X(),_=Math.floor((f+a)/2),v=Math.floor((p+m)/2),P=d.row===_&&d.col===v,H=a-f+1===b&&m-p+1===b;return P&&H}function M(){const{minRow:f,maxRow:a,minCol:p,maxCol:m}=X(),_=a-f+1===b&&m-p+1===b;for(let v=c.row;v<c.row+b;v++)for(let P=c.col;P<c.col+b;P++)if((v!==d.row||P!==d.col)&&h[v][P].terrain===null)return!1;return _}function $(){const f=Array.from({length:D},()=>Array(D).fill(!1));let a=0;function p(m,_,v){if(m<0||m>=D||_<0||_>=D||f[m][_]||h[m][_].terrain!==v)return[0,0];f[m][_]=!0;let P=1,H=h[m][_].crowns;for(const[se,ce]of[[1,0],[-1,0],[0,1],[0,-1]]){const[fe,ue]=p(m+se,_+ce,v);P+=fe,H+=ue}return[P,H]}for(let m=0;m<D;m++)for(let _=0;_<D;_++){const v=h[m][_];if(v.terrain&&!f[m][_]){const[P,H]=p(m,_,v.terrain);a+=P*H}}return a+=C()?10:0,a+=M()?5:0,a}function X(){let f=D,a=-1,p=D,m=-1;for(let _=0;_<D;_++)for(let v=0;v<D;v++)(h[_][v].terrain!==null||_===d.row&&v===d.col)&&(f=Math.min(f,_),a=Math.max(a,_),p=Math.min(p,v),m=Math.max(m,v));return{minRow:f,maxRow:a,minCol:p,maxCol:m}}let ne=0;function i(){if(b===5)n(0,b=7),c.row>0&&n(14,c.row-=1,c),c.col>0&&n(14,c.col-=1,c);else{const f=X();if(f.maxRow-f.minRow>=5||f.maxCol-f.minCol>=5)return;const a=f.maxRow<c.row+6?c.row+1:c.row,p=f.maxCol<c.col+6?c.col+1:c.col;n(14,c={row:a,col:p}),n(0,b=5)}}const g=f=>n(2,O=f),u=(f,a,p)=>K(f,a,p),G=(f,a,p,m)=>E(f,a,p),Le=f=>B(f),Pe=f=>S(f),ze=f=>q(f),De=()=>i();return e.$$.update=()=>{e.$$.dirty[0]&24577&&n(4,o=Array.from({length:b},(f,a)=>Array.from({length:b},(p,m)=>{const _=c.row+a,v=c.col+m;return{tile:h[_][v],row:_,col:v}})))},[b,L,O,ne,o,w,E,S,B,q,K,y,i,h,c,g,u,G,Le,Pe,ze,De]}class st extends ot{constructor(t){super(),nt(this,t,it,rt,Ve,{},null,[-1,-1])}}new st({target:document.body});
