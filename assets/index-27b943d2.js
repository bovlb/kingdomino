var Fe=Object.defineProperty;var qe=(e,t,n)=>t in e?Fe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var me=(e,t,n)=>(qe(e,typeof t!="symbol"?t+"":t,n),n);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&o(f)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function o(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function fe(){}function De(e){return e()}function ye(){return Object.create(null)}function re(e){e.forEach(De)}function Pe(e){return typeof e=="function"}function Ke(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function He(e){return Object.keys(e).length===0}function Ue(e){return e??""}function I(e,t){e.appendChild(t)}function N(e,t,n){e.insertBefore(t,n||null)}function A(e){e.parentNode&&e.parentNode.removeChild(e)}function ae(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function j(e){return document.createElement(e)}function q(e){return document.createTextNode(e)}function x(){return q(" ")}function Ge(){return q("")}function ee(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function B(e,t,n){n==null?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function Je(e){return Array.from(e.childNodes)}function se(e,t){t=""+t,e.data!==t&&(e.data=t)}function te(e,t,n,o){n==null?e.style.removeProperty(t):e.style.setProperty(t,n,o?"important":"")}function R(e,t,n){e.classList.toggle(t,!!n)}let ue;function ce(e){ue=e}function Te(){if(!ue)throw new Error("Function called outside component initialization");return ue}function Qe(e){Te().$$.on_mount.push(e)}function We(e){Te().$$.on_destroy.push(e)}const oe=[],ve=[];let le=[];const ke=[],Xe=Promise.resolve();let we=!1;function Ye(){we||(we=!0,Xe.then(ze))}function be(e){le.push(e)}const ge=new Set;let ne=0;function ze(){if(ne!==0)return;const e=ue;do{try{for(;ne<oe.length;){const t=oe[ne];ne++,ce(t),Ze(t.$$)}}catch(t){throw oe.length=0,ne=0,t}for(ce(null),oe.length=0,ne=0;ve.length;)ve.pop()();for(let t=0;t<le.length;t+=1){const n=le[t];ge.has(n)||(ge.add(n),n())}le.length=0}while(oe.length);for(;ke.length;)ke.pop()();we=!1,ge.clear(),ce(e)}function Ze(e){if(e.fragment!==null){e.update(),re(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(be)}}function xe(e){const t=[],n=[];le.forEach(o=>e.indexOf(o)===-1?t.push(o):n.push(o)),n.forEach(o=>o()),le=t}const et=new Set;function Ie(e,t){e&&e.i&&(et.delete(e),e.i(t))}function H(e){return(e==null?void 0:e.length)!==void 0?e:Array.from(e)}function tt(e,t){e.d(1),t.delete(e.key)}function nt(e,t,n,o,r,s,f,k,m,b,D,g){let d=e.length,u=s.length,y=d;const U={};for(;y--;)U[e[y].key]=y;const S=[],W=new Map,F=new Map,X=[];for(y=u;y--;){const v=g(r,s,y),L=n(v);let C=f.get(L);C?o&&X.push(()=>C.p(v,t)):(C=b(L,v),C.c()),W.set(L,S[y]=C),L in U&&F.set(L,Math.abs(y-U[L]))}const G=new Set,P=new Set;function T(v){Ie(v,1),v.m(k,D),f.set(v.key,v),D=v.first,u--}for(;d&&u;){const v=S[u-1],L=e[d-1],C=v.key,M=L.key;v===L?(D=v.first,d--,u--):W.has(M)?!f.has(C)||G.has(C)?T(v):P.has(M)?d--:F.get(C)>F.get(M)?(P.add(C),T(v)):(G.add(M),d--):(m(L,f),d--)}for(;d--;){const v=e[d];W.has(v.key)||m(v,f)}for(;u;)T(S[u-1]);return re(X),S}function ot(e,t,n){const{fragment:o,after_update:r}=e.$$;o&&o.m(t,n),be(()=>{const s=e.$$.on_mount.map(De).filter(Pe);e.$$.on_destroy?e.$$.on_destroy.push(...s):re(s),e.$$.on_mount=[]}),r.forEach(be)}function lt(e,t){const n=e.$$;n.fragment!==null&&(xe(n.after_update),re(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function rt(e,t){e.$$.dirty[0]===-1&&(oe.push(e),Ye(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function it(e,t,n,o,r,s,f=null,k=[-1]){const m=ue;ce(e);const b=e.$$={fragment:null,ctx:[],props:s,update:fe,not_equal:r,bound:ye(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(m?m.$$.context:[])),callbacks:ye(),dirty:k,skip_bound:!1,root:t.target||m.$$.root};f&&f(b.root);let D=!1;if(b.ctx=n?n(e,t.props||{},(g,d,...u)=>{const y=u.length?u[0]:d;return b.ctx&&r(b.ctx[g],b.ctx[g]=y)&&(!b.skip_bound&&b.bound[g]&&b.bound[g](y),D&&rt(e,g)),d}):[],b.update(),D=!0,re(b.before_update),b.fragment=o?o(b.ctx):!1,t.target){if(t.hydrate){const g=Je(t.target);b.fragment&&b.fragment.l(g),g.forEach(A)}else b.fragment&&b.fragment.c();t.intro&&Ie(e.$$.fragment),ot(e,t.target,t.anchor),ze()}ce(m)}class st{constructor(){me(this,"$$");me(this,"$$set")}$destroy(){lt(this,1),this.$destroy=fe}$on(t,n){if(!Pe(n))return fe;const o=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return o.push(n),()=>{const r=o.indexOf(n);r!==-1&&o.splice(r,1)}}$set(t){this.$$set&&!He(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const ct="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(ct);function $e(e,t,n){const o=e.slice();return o[37]=t[n],o}function Ce(e,t,n){const o=e.slice();return o[40]=t[n],o}function Me(e,t,n){const o=e.slice();return o[43]=t[n],o}function Re(e,t,n){const o=e.slice();return o[46]=t[n].tile,o[47]=t[n].row,o[48]=t[n].col,o}function Se(e,t,n){const o=e.slice();return o[51]=t[n],o}function Ee(e){let t,n,o;function r(){return e[16](e[51])}return{c(){t=j("button"),t.textContent=`${e[51]} ðŸ‘‘`,B(t,"class","svelte-ue42gi"),R(t,"selected",e[3]===e[51])},m(s,f){N(s,t,f),n||(o=ee(t,"click",r),n=!0)},p(s,f){e=s,f[0]&8&&R(t,"selected",e[3]===e[51])},d(s){s&&A(t),n=!1,o()}}}function Oe(e){let t,n=(e[46].crowns>0?e[46].crowns:"")+"",o,r,s,f,k,m;function b(){return e[17](e[46],e[47],e[48])}function D(...d){return e[18](e[46],e[47],e[48],...d)}function g(){return e[20](e[47],e[48])}return{c(){t=j("button"),o=q(n),r=x(),B(t,"data-row",s=e[47]),B(t,"data-col",f=e[48]),B(t,"class","tile svelte-ue42gi"),R(t,"grass",e[46].terrain==="grass"),R(t,"water",e[46].terrain==="water"),R(t,"forest",e[46].terrain==="forest"),R(t,"wheat",e[46].terrain==="wheat"),R(t,"swamp",e[46].terrain==="swamp"),R(t,"mine",e[46].terrain==="mine"),R(t,"castle",e[12](e[47],e[48]))},m(d,u){N(d,t,u),I(t,o),I(t,r),k||(m=[ee(t,"click",b),ee(t,"pointerdown",D),ee(t,"pointermove",e[19]),ee(t,"pointerup",g)],k=!0)},p(d,u){e=d,u[0]&32&&n!==(n=(e[46].crowns>0?e[46].crowns:"")+"")&&se(o,n),u[0]&32&&s!==(s=e[47])&&B(t,"data-row",s),u[0]&32&&f!==(f=e[48])&&B(t,"data-col",f),u[0]&32&&R(t,"grass",e[46].terrain==="grass"),u[0]&32&&R(t,"water",e[46].terrain==="water"),u[0]&32&&R(t,"forest",e[46].terrain==="forest"),u[0]&32&&R(t,"wheat",e[46].terrain==="wheat"),u[0]&32&&R(t,"swamp",e[46].terrain==="swamp"),u[0]&32&&R(t,"mine",e[46].terrain==="mine"),u[0]&4128&&R(t,"castle",e[12](e[47],e[48]))},d(d){d&&A(t),k=!1,re(m)}}}function Ae(e){let t,n=H(e[43]),o=[];for(let r=0;r<n.length;r+=1)o[r]=Oe(Re(e,n,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();t=Ge()},m(r,s){for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(r,s);N(r,t,s)},p(r,s){if(s[0]&7072){n=H(r[43]);let f;for(f=0;f<n.length;f+=1){const k=Re(r,n,f);o[f]?o[f].p(k,s):(o[f]=Oe(k),o[f].c(),o[f].m(t.parentNode,t))}for(;f<o.length;f+=1)o[f].d(1);o.length=n.length}},d(r){r&&A(t),ae(o,r)}}}function Le(e,t){let n,o=t[40]+"",r,s,f;function k(){return t[21](t[40])}return{key:e,first:null,c(){n=j("button"),r=q(o),B(n,"class",Ue(t[40])+" svelte-ue42gi"),R(n,"selected",t[2]===t[40]),this.first=n},m(m,b){N(m,n,b),I(n,r),s||(f=ee(n,"click",k),s=!0)},p(m,b){t=m,b[0]&68&&R(n,"selected",t[2]===t[40])},d(m){m&&A(n),s=!1,f()}}}function Ne(e){let t,n=e[37]+"",o;return{c(){t=j("div"),o=q(n)},m(r,s){N(r,t,s),I(t,o)},p(r,s){s[0]&2&&n!==(n=r[37]+"")&&se(o,n)},d(r){r&&A(t)}}}function ft(e){let t,n,o,r,s,f,k,m=[],b=new Map,D,g,d,u,y,U,S,W,F,X,G,P,T,v,L,C=H([0,1,2,3]),M=[];for(let l=0;l<4;l+=1)M[l]=Ee(Se(e,C,l));let Y=H(e[5]),E=[];for(let l=0;l<Y.length;l+=1)E[l]=Ae(Me(e,Y,l));let J=H(["empty",...e[6]]);const ie=l=>l[40];for(let l=0;l<J.length;l+=1){let w=Ce(e,J,l),i=ie(w);b.set(i,m[l]=Le(i,w))}let Q=H(e[1]),O=[];for(let l=0;l<Q.length;l+=1)O[l]=Ne($e(e,Q,l));return{c(){t=j("h1"),t.textContent="Kingdomino Scorer",n=x(),o=j("div");for(let l=0;l<4;l+=1)M[l].c();r=x(),s=j("div");for(let l=0;l<E.length;l+=1)E[l].c();f=x(),k=j("div");for(let l=0;l<m.length;l+=1)m[l].c();D=x(),g=j("p"),d=q("Total Score: "),u=j("strong"),y=q(e[4]),U=x(),S=j("button"),W=q("Board Size: "),F=q(e[0]),X=q("Ã—"),G=q(e[0]),P=x(),T=j("div");for(let l=0;l<O.length;l+=1)O[l].c();te(t,"text-align","center"),B(o,"class","crown-controls controls svelte-ue42gi"),B(s,"class","board svelte-ue42gi"),te(s,"grid-template-columns","repeat("+e[0]+", 1fr)"),B(k,"class","controls svelte-ue42gi"),te(S,"margin-left","20px"),B(S,"class","svelte-ue42gi"),te(g,"text-align","center"),te(g,"font-size","1.2rem"),B(T,"class","debug-log svelte-ue42gi")},m(l,w){N(l,t,w),N(l,n,w),N(l,o,w);for(let i=0;i<4;i+=1)M[i]&&M[i].m(o,null);N(l,r,w),N(l,s,w);for(let i=0;i<E.length;i+=1)E[i]&&E[i].m(s,null);N(l,f,w),N(l,k,w);for(let i=0;i<m.length;i+=1)m[i]&&m[i].m(k,null);N(l,D,w),N(l,g,w),I(g,d),I(g,u),I(u,y),I(g,U),I(g,S),I(S,W),I(S,F),I(S,X),I(S,G),N(l,P,w),N(l,T,w);for(let i=0;i<O.length;i+=1)O[i]&&O[i].m(T,null);v||(L=ee(S,"click",e[22]),v=!0)},p(l,w){if(w[0]&8){C=H([0,1,2,3]);let i;for(i=0;i<4;i+=1){const K=Se(l,C,i);M[i]?M[i].p(K,w):(M[i]=Ee(K),M[i].c(),M[i].m(o,null))}for(;i<4;i+=1)M[i].d(1)}if(w[0]&7072){Y=H(l[5]);let i;for(i=0;i<Y.length;i+=1){const K=Me(l,Y,i);E[i]?E[i].p(K,w):(E[i]=Ae(K),E[i].c(),E[i].m(s,null))}for(;i<E.length;i+=1)E[i].d(1);E.length=Y.length}if(w[0]&1&&te(s,"grid-template-columns","repeat("+l[0]+", 1fr)"),w[0]&1092&&(J=H(["empty",...l[6]]),m=nt(m,w,ie,1,l,J,b,k,tt,Le,null,Ce)),w[0]&16&&se(y,l[4]),w[0]&1&&se(F,l[0]),w[0]&1&&se(G,l[0]),w[0]&2){Q=H(l[1]);let i;for(i=0;i<Q.length;i+=1){const K=$e(l,Q,i);O[i]?O[i].p(K,w):(O[i]=Ne(K),O[i].c(),O[i].m(T,null))}for(;i<O.length;i+=1)O[i].d(1);O.length=Q.length}},i:fe,o:fe,d(l){l&&(A(t),A(n),A(o),A(r),A(s),A(f),A(k),A(D),A(g),A(P),A(T)),ae(M,l),ae(E,l);for(let w=0;w<m.length;w+=1)m[w].d();ae(O,l),v=!1,L()}}}const V=13;function ut(e,t,n){let o,r=[];function s(c){n(1,r=[...r,c].slice(-10))}let f=!1,k=null,m=null;function b(){f=!1,k=null,m=null}Qe(()=>{window.addEventListener("pointerup",b),window.addEventListener("pointercancel",b)}),We(()=>{window.removeEventListener("pointerup",b),window.removeEventListener("pointercancel",b)});const D=["grass","water","forest","wheat","swamp","mine"];let g=Array.from({length:V},()=>Array.from({length:V},()=>({terrain:null,crowns:0}))),d=5,u={row:4,col:4},y={row:6,col:6};function U(c,a,h){s(`beginDrag: ${a}, ${h}`),C(a,h)?m={row:a,col:h}:(f=!0,k=P==="empty"?null:P,G(c,a,h))}function S(c,a){if(s(`endDrag: ${c}, ${a}`),m){const h=c-m.row,_=a-m.col;W(y.row+h,y.col+_),m=null}f=!1,k=null}function W(c,a){const h=c-y.row,_=a-y.col,p={row:u.row-h,col:u.col-_},{minRow:$,maxRow:z,minCol:Z,maxCol:de}=J(),he=p.row,_e=p.row+d-1,pe=p.col,Be=p.col+d-1;return $>=he&&z<=_e&&Z>=pe&&de<=Be?(n(15,u=p),F(),!0):!1}function F(){n(14,g=[...g]),n(4,ie=E())}function X(c){if(!f||k===null)return;const a=c.currentTarget,h=parseInt(a.dataset.row??""),_=parseInt(a.dataset.col??"");if(s(`handlePointerMove: ${h}, ${_}`),!isNaN(h)&&!isNaN(_)){const p=g[h][_];G(p,h,_)}}function G(c,a,h){s(`applyDrag: ${a}, ${h}`),!C(a,h)&&f&&k!==null&&(c.terrain=k,c.crowns=Math.floor(Math.random()*4),F())}let P="grass";function T(c){n(2,P=c)}let v=null;function L(c,a,h){C(a,h)||(c.terrain=P==="empty"?null:P,v!==null&&(c.crowns=v,n(3,v=null)),F())}function C(c,a){return c===y.row&&a===y.col}function M(){const{minRow:c,maxRow:a,minCol:h,maxCol:_}=J(),p=Math.floor((c+a)/2),$=Math.floor((h+_)/2),z=y.row===p&&y.col===$,Z=a-c+1===d&&_-h+1===d;return z&&Z}function Y(){const{minRow:c,maxRow:a,minCol:h,maxCol:_}=J(),p=a-c+1===d&&_-h+1===d;for(let $=u.row;$<u.row+d;$++)for(let z=u.col;z<u.col+d;z++)if(($!==y.row||z!==y.col)&&g[$][z].terrain===null)return!1;return p}function E(){const c=Array.from({length:V},()=>Array(V).fill(!1));let a=0;function h(_,p,$){if(_<0||_>=V||p<0||p>=V||c[_][p]||g[_][p].terrain!==$)return[0,0];c[_][p]=!0;let z=1,Z=g[_][p].crowns;for(const[de,he]of[[1,0],[-1,0],[0,1],[0,-1]]){const[_e,pe]=h(_+de,p+he,$);z+=_e,Z+=pe}return[z,Z]}for(let _=0;_<V;_++)for(let p=0;p<V;p++){const $=g[_][p];if($.terrain&&!c[_][p]){const[z,Z]=h(_,p,$.terrain);a+=z*Z}}return a+=M()?10:0,a+=Y()?5:0,a}function J(){let c=V,a=-1,h=V,_=-1;for(let p=0;p<V;p++)for(let $=0;$<V;$++)(g[p][$].terrain!==null||p===y.row&&$===y.col)&&(c=Math.min(c,p),a=Math.max(a,p),h=Math.min(h,$),_=Math.max(_,$));return{minRow:c,maxRow:a,minCol:h,maxCol:_}}let ie=0;function Q(){if(d===5)n(0,d=7),u.row>0&&n(15,u.row-=1,u),u.col>0&&n(15,u.col-=1,u);else{const c=J();if(c.maxRow-c.minRow>=5||c.maxCol-c.minCol>=5)return;const a=c.maxRow<u.row+6?u.row+1:u.row,h=c.maxCol<u.col+6?u.col+1:u.col;n(15,u={row:a,col:h}),n(0,d=5)}}const O=c=>n(3,v=c),l=(c,a,h)=>L(c,a,h),w=(c,a,h,_)=>U(c,a,h),i=c=>X(c),K=(c,a)=>S(c,a),Ve=c=>T(c),je=()=>Q();return e.$$.update=()=>{e.$$.dirty[0]&49153&&n(5,o=Array.from({length:d},(c,a)=>Array.from({length:d},(h,_)=>{const p=u.row+a,$=u.col+_;return{tile:g[p][$],row:p,col:$}})))},[d,r,P,v,ie,o,D,U,S,X,T,L,C,Q,g,u,O,l,w,i,K,Ve,je]}class at extends st{constructor(t){super(),it(this,t,ut,ft,Ke,{},null,[-1,-1])}}new at({target:document.body});
